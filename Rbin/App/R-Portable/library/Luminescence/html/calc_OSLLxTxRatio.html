<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Calculate 'Lx/Tx' ratio for CW-OSL curves</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for calc_OSLLxTxRatio {Luminescence}"><tr><td>calc_OSLLxTxRatio {Luminescence}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Calculate <code>Lx/Tx</code> ratio for CW-OSL curves</h2>

<h3>Description</h3>

<p>Calculate <code>Lx/Tx</code> ratios from a given set of CW-OSL curves assuming late light
background subtraction.
</p>


<h3>Usage</h3>

<pre>
calc_OSLLxTxRatio(
  Lx.data,
  Tx.data = NULL,
  signal.integral,
  signal.integral.Tx = NULL,
  background.integral,
  background.integral.Tx = NULL,
  background.count.distribution = "non-poisson",
  use_previousBG = FALSE,
  sigmab = NULL,
  sig0 = 0,
  digits = NULL
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>Lx.data</code></td>
<td>
<p><a href="../../Luminescence/help/RLum.Data.Curve-class.html">RLum.Data.Curve</a> or <a href="../../base/html/data.frame.html">data.frame</a> (<strong>required</strong>):
requires a CW-OSL shine down curve (x = time, y = counts)</p>
</td></tr>
<tr valign="top"><td><code>Tx.data</code></td>
<td>
<p><a href="../../Luminescence/help/RLum.Data.Curve-class.html">RLum.Data.Curve</a> or <a href="../../base/html/data.frame.html">data.frame</a> (<em>optional</em>):
requires a CW-OSL shine down curve (x = time, y = counts). If no
input is given the <code>Tx.data</code> will be treated as <code>NA</code> and no <code>Lx/Tx</code> ratio
is calculated.</p>
</td></tr>
<tr valign="top"><td><code>signal.integral</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<strong>required</strong>): vector with the limits for the signal integral.
Can be set to <code>NA</code> than now integrals are considered and all other integrals are set to <code>NA</code> as well.</p>
</td></tr>
<tr valign="top"><td><code>signal.integral.Tx</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<em>optional</em>):
vector with the limits for the signal integral for the <code>Tx</code>-curve. If nothing is provided the
value from <code>signal.integral</code> is used.</p>
</td></tr>
<tr valign="top"><td><code>background.integral</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<strong>required</strong>):
vector with the bounds for the background integral.
Can be set to <code>NA</code> than now integrals are considered and all other integrals are set to <code>NA</code> as well.</p>
</td></tr>
<tr valign="top"><td><code>background.integral.Tx</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<em>optional</em>):
vector with the limits for the background integral for the <code>Tx</code> curve.
If nothing is provided the value from <code>background.integral</code> is used.</p>
</td></tr>
<tr valign="top"><td><code>background.count.distribution</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> (<em>with default</em>):
sets the count distribution assumed for the error calculation.
Possible arguments <code>poisson</code> or <code>non-poisson</code>. See details for further information</p>
</td></tr>
<tr valign="top"><td><code>use_previousBG</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
If set to <code>TRUE</code> the background of the <code>Lx</code>-signal is subtracted also
from the <code>Tx</code>-signal. Please note that in this case separate
signal integral limits for the <code>Tx</code>-signal are not allowed and will be reset.</p>
</td></tr>
<tr valign="top"><td><code>sigmab</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<em>optional</em>):
option to set a manual value for the overdispersion (for <code>LnTx</code> and <code>TnTx</code>),
used for the <code>Lx/Tx</code> error calculation. The value should be provided as
absolute squared count values, e.g. <code>sigmab = c(300,300)</code>.
<strong>Note:</strong> If only one value is provided this value is taken for both (<code>LnTx</code> and <code>TnTx</code>) signals.</p>
</td></tr>
<tr valign="top"><td><code>sig0</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<em>with default</em>):
allow adding an extra component of error to the final <code>Lx/Tx</code> error value
(e.g., instrumental error, see details).</p>
</td></tr>
<tr valign="top"><td><code>digits</code></td>
<td>
<p><a href="../../base/html/integer.html">integer</a> (<em>with default</em>):
round numbers to the specified digits.
If digits is set to <code>NULL</code> nothing is rounded.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The integrity of the chosen values for the signal and background integral is
checked by the function; the signal integral limits have to be lower than
the background integral limits. If a <a href="../../base/html/vector.html">vector</a> is given as input instead
of a <a href="../../base/html/data.frame.html">data.frame</a>, an artificial <a href="../../base/html/data.frame.html">data.frame</a> is produced. The
error calculation is done according to Galbraith (2002).
</p>
<p><strong>Please note:</strong> In cases where the calculation results in <code>NaN</code> values (for
example due to zero-signal, and therefore a division of 0 by 0), these <code>NaN</code>
values are replaced by 0.
</p>
<p><strong><code>sigmab</code></strong>
</p>
<p>The default value of <code>sigmab</code> is calculated assuming the background is
constant and <strong>would not</strong> applicable when the background varies as,
e.g., as observed for the early light subtraction method.
</p>
<p><strong>sig0</strong>
</p>
<p>This argument allows to add an extra component of error to the final <code>Lx/Tx</code>
error value. The input will be treated as factor that is multiplied with
the already calculated <code>LxTx</code> and the result is add up by:
</p>
<p style="text-align: center;"><i>se(LxTx) = &radic;(se(LxTx)^2 + (LxTx * sig0)^2)</i></p>

<p><strong>background.count.distribution</strong>
</p>
<p>This argument allows selecting the distribution assumption that is used for
the error calculation. According to Galbraith (2002, 2014) the background
counts may be overdispersed (i.e. do not follow a Poisson distribution,
which is assumed for the photomultiplier counts). In that case (might be the
normal case) it has to be accounted for the overdispersion by estimating
<i>&sigma;^2</i> (i.e. the overdispersion value). Therefore the relative
standard error is calculated as:
</p>

<ul>
<li> <p><code>poisson</code>
</p>
<p style="text-align: center;"><i>rse(&mu;_{S}) \approx &radic;(Y_{0} + Y_{1}/k^2)/Y_{0} - Y_{1}/k</i></p>

</li>
<li> <p><code>non-poisson</code>
</p>
<p style="text-align: center;"><i>rse(&mu;_{S}) \approx &radic;(Y_{0} + Y_{1}/k^2 + &sigma;^2(1+1/k))/Y_{0} - Y_{1}/k</i></p>

</li></ul>

<p><strong>Please note</strong> that when using the early background subtraction method in
combination with the 'non-poisson' distribution argument, the corresponding <code>Lx/Tx</code> error
may considerably increase due to a high <code>sigmab</code> value.
Please check whether this is valid for your data set and  if necessary
consider to provide an own <code>sigmab</code> value using the corresponding argument <code>sigmab</code>.
</p>


<h3>Value</h3>

<p>Returns an S4 object of type <a href="../../Luminescence/help/RLum.Results-class.html">RLum.Results</a>.
</p>
<p>Slot <code>data</code> contains a <a href="../../base/html/list.html">list</a> with the following structure:
</p>
<p><strong>@data</strong></p>
<pre>$LxTx.table (data.frame)
.. $ LnLx
.. $ LnLx.BG
.. $ TnTx
.. $ TnTx.BG
.. $ Net_LnLx
.. $ Net_LnLx.Error
.. $ Net_TnTx.Error
.. $ LxTx
.. $ LxTx.Error
$ calc.parameters (list)
.. $ sigmab.LnTx
.. $ sigmab.TnTx
.. $ k
</pre>
<p><strong>@info</strong></p>
<pre>$ call (original function call)
</pre>


<h3>Function version</h3>

<p>0.8.0
</p>


<h3>How to cite</h3>

<p>Kreutzer, S., 2021. calc_OSLLxTxRatio(): Calculate Lx/Tx ratio for CW-OSL curves. Function version 0.8.0. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., 2021. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.15. https://CRAN.R-project.org/package=Luminescence
</p>


<h3>Note</h3>

<p>The results of this function have been cross-checked with the Analyst
(version 3.24b). Access to the results object via <a href="../../Luminescence/help/get_RLum.html">get_RLum</a>.
</p>
<p><strong>Caution:</strong> If you are using early light subtraction (EBG), please either provide your
own <code>sigmab</code> value or use <code>background.count.distribution = "poisson"</code>.
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, Geography &amp; Earth Sciences, Aberystwyth University (United Kingdom)
, RLum Developer Team</p>


<h3>References</h3>

<p>Duller, G., 2018. Analyst v4.57 - User Manual.
<a href="https://users.aber.ac.uk/ggd/">https://users.aber.ac.uk/ggd/</a><br />
</p>
<p>Galbraith, R.F., 2002. A note on the variance of a background-corrected OSL
count. Ancient TL, 20 (2), 49-51.
</p>
<p>Galbraith, R.F., 2014. A further note on the variance of a
background-corrected OSL count. Ancient TL, 31 (2), 1-3.
</p>


<h3>See Also</h3>

<p><a href="../../Luminescence/help/RLum.Data.Curve-class.html">RLum.Data.Curve</a>, <a href="../../Luminescence/help/Analyse_SAR.OSLdata.html">Analyse_SAR.OSLdata</a>, <a href="../../Luminescence/help/plot_GrowthCurve.html">plot_GrowthCurve</a>,
<a href="../../Luminescence/help/analyse_SAR.CWOSL.html">analyse_SAR.CWOSL</a>
</p>


<h3>Examples</h3>

<pre>

##load data
data(ExampleData.LxTxOSLData, envir = environment())

##calculate Lx/Tx ratio
results &lt;- calc_OSLLxTxRatio(Lx.data, Tx.data, signal.integral = c(1:2),
                             background.integral = c(85:100))

##get results object
get_RLum(results)

</pre>

<hr /><div style="text-align: center;">[Package <em>Luminescence</em> version 0.9.15 <a href="00Index.html">Index</a>]</div>
</div></body></html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Apply the finite mixture model (FMM) after Galbraith (2005)...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for calc_FiniteMixture {Luminescence}"><tr><td>calc_FiniteMixture {Luminescence}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Apply the finite mixture model (FMM) after Galbraith (2005) to a given De
distribution</h2>

<h3>Description</h3>

<p>This function fits a k-component mixture to a De distribution with differing
known standard errors. Parameters (doses and mixing proportions) are
estimated by maximum likelihood assuming that the log dose estimates are
from a mixture of normal distributions.
</p>


<h3>Usage</h3>

<pre>
calc_FiniteMixture(
  data,
  sigmab,
  n.components,
  grain.probability = FALSE,
  dose.scale,
  pdf.weight = TRUE,
  pdf.sigma = "sigmab",
  pdf.colors = "gray",
  pdf.scale,
  plot.proportions = TRUE,
  plot = TRUE,
  ...
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
<p><a href="../../Luminescence/help/RLum.Results-class.html">RLum.Results</a> or <a href="../../base/html/data.frame.html">data.frame</a> (<strong>required</strong>):
for <a href="../../base/html/data.frame.html">data.frame</a>: two columns with De <code>(data[,1])</code> and De error <code>(values[,2])</code></p>
</td></tr>
<tr valign="top"><td><code>sigmab</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<strong>required</strong>):
spread in De values given as a fraction (e.g. 0.2). This value represents the expected
overdispersion in the data should the sample be well-bleached
(Cunningham &amp; Wallinga 2012, p. 100).</p>
</td></tr>
<tr valign="top"><td><code>n.components</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<strong>required</strong>):
number of components to be fitted. If a vector is provided (e.g. <code>c(2:8)</code>) the
finite mixtures for 2, 3 ... 8 components are calculated and a plot and a
statistical evaluation of the model performance (BIC score and maximum
log-likelihood) is provided.</p>
</td></tr>
<tr valign="top"><td><code>grain.probability</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
prints the estimated probabilities of which component each grain is in</p>
</td></tr>
<tr valign="top"><td><code>dose.scale</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a>:
manually set the scaling of the y-axis of the first plot with a vector
in the form of <code>c(min, max)</code></p>
</td></tr>
<tr valign="top"><td><code>pdf.weight</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
weight the probability density functions by the components proportion (applies only
when a vector is provided for <code>n.components</code>)</p>
</td></tr>
<tr valign="top"><td><code>pdf.sigma</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> (<em>with default</em>):
if <code>"sigmab"</code> the components normal distributions are plotted with a common standard
deviation (i.e. <code>sigmab</code>) as assumed by the FFM. Alternatively,
<code>"se"</code> takes the standard error of each component for the sigma
parameter of the normal distribution</p>
</td></tr>
<tr valign="top"><td><code>pdf.colors</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> (<em>with default</em>):
colour coding of the components in the the plot.
Possible options are <code>"gray"</code>, <code>"colors"</code> and <code>"none"</code></p>
</td></tr>
<tr valign="top"><td><code>pdf.scale</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a>:
manually set the max density value for proper scaling of the x-axis of the first plot</p>
</td></tr>
<tr valign="top"><td><code>plot.proportions</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
plot <a href="../../graphics/help/barplot.html">graphics::barplot</a> showing the proportions of components if
<code>n.components</code> a vector with a length &gt; 1 (e.g., <code>n.components = c(2:3)</code>)</p>
</td></tr>
<tr valign="top"><td><code>plot</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):  plot output</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments to pass. See details for their usage.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This model uses the maximum likelihood and Bayesian Information Criterion
(BIC) approaches.
</p>
<p>Indications of overfitting are:
</p>

<ul>
<li><p> increasing BIC
</p>
</li>
<li><p> repeated dose estimates
</p>
</li>
<li><p> covariance matrix not positive definite
</p>
</li>
<li><p> covariance matrix produces <code>NaN</code>
</p>
</li>
<li><p> convergence problems
</p>
</li></ul>

<p><strong>Plot</strong>
</p>
<p>If a vector (<code>c(k.min:k.max)</code>) is provided
for <code>n.components</code> a plot is generated showing the the k components
equivalent doses as normal distributions. By default <code>pdf.weight</code> is
set to <code>FALSE</code>, so that the area under each normal distribution is
always 1. If <code>TRUE</code>, the probability density functions are weighted by
the components proportion for each iteration of k components, so the sum of
areas of each component equals 1. While the density values are on the same
scale when no weights are used, the y-axis are individually scaled if the
probability density are weighted by the components proportion.<br />
The standard deviation (sigma) of the normal distributions is by default
determined by a common <code>sigmab</code> (see <code>pdf.sigma</code>). For
<code>pdf.sigma = "se"</code> the standard error of each component is taken
instead.<br />
The stacked <a href="../../graphics/help/barplot.html">graphics::barplot</a> shows the proportion of each component (in
per cent) calculated by the FFM. The last plot shows the achieved BIC scores
and maximum log-likelihood estimates for each iteration of k.
</p>


<h3>Value</h3>

<p>Returns a plot (<em>optional</em>) and terminal output. In addition an
<a href="../../Luminescence/help/RLum.Results-class.html">RLum.Results</a> object is returned containing the
following elements:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>.$summary</code></td>
<td>
<p><a href="../../base/html/data.frame.html">data.frame</a> summary of all relevant model results.</p>
</td></tr>
<tr valign="top"><td><code>.$data</code></td>
<td>
<p><a href="../../base/html/data.frame.html">data.frame</a> original input data</p>
</td></tr>
<tr valign="top"><td><code>.$args</code></td>
<td>
<p><a href="../../base/html/list.html">list</a> used arguments</p>
</td></tr>
<tr valign="top"><td><code>.$call</code></td>
<td>
<p><a href="../../base/html/call.html">call</a> the function call</p>
</td></tr>
<tr valign="top"><td><code>.$mle</code></td>
<td>
<p> covariance matrices of the log likelihoods</p>
</td></tr>
<tr valign="top"><td><code>.$BIC</code></td>
<td>
<p> BIC score</p>
</td></tr>
<tr valign="top"><td><code>.$llik</code></td>
<td>
<p> maximum log likelihood</p>
</td></tr>
<tr valign="top"><td><code>.$grain.probability</code></td>
<td>
<p> probabilities of a grain belonging to a component</p>
</td></tr>
<tr valign="top"><td><code>.$components</code></td>
<td>
<p><a href="../../base/html/matrix.html">matrix</a> estimates of the de, de error and proportion for each component</p>
</td></tr>
<tr valign="top"><td><code>.$single.comp</code></td>
<td>
<p><a href="../../base/html/data.frame.html">data.frame</a> single component FFM estimate</p>
</td></tr>
</table>
<p>If a vector for <code>n.components</code> is provided (e.g.  <code>c(2:8)</code>),
<code>mle</code> and <code>grain.probability</code> are lists containing matrices of the
results for each iteration of the model.
</p>
<p>The output should be accessed using the function <a href="../../Luminescence/help/get_RLum.html">get_RLum</a>
</p>


<h3>Function version</h3>

<p>0.4.2
</p>


<h3>How to cite</h3>

<p>Burow, C., 2021. calc_FiniteMixture(): Apply the finite mixture model (FMM) after Galbraith (2005) to a given De distribution. Function version 0.4.2. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., 2021. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.15. https://CRAN.R-project.org/package=Luminescence
</p>


<h3>Author(s)</h3>

<p>Christoph Burow, University of Cologne (Germany) <br />
Based on a rewritten S script of Rex Galbraith, 2006.
, RLum Developer Team</p>


<h3>References</h3>

<p>Galbraith, R.F. &amp; Green, P.F., 1990. Estimating the component
ages in a finite mixture. Nuclear Tracks and Radiation Measurements 17,
197-206.
</p>
<p>Galbraith, R.F. &amp; Laslett, G.M., 1993. Statistical models
for mixed fission track ages. Nuclear Tracks Radiation Measurements 4,
459-470.
</p>
<p>Galbraith, R.F. &amp; Roberts, R.G., 2012. Statistical aspects of
equivalent dose and error calculation and display in OSL dating: An overview
and some recommendations. Quaternary Geochronology 11, 1-27.
</p>
<p>Roberts, R.G., Galbraith, R.F., Yoshida, H., Laslett, G.M. &amp; Olley, J.M., 2000.
Distinguishing dose populations in sediment mixtures: a test of single-grain
optical dating procedures using mixtures of laboratory-dosed quartz.
Radiation Measurements 32, 459-465.
</p>
<p>Galbraith, R.F., 2005. Statistics for Fission Track Analysis, Chapman &amp; Hall/CRC, Boca Raton.
</p>
<p><strong>Further reading</strong>
</p>
<p>Arnold, L.J. &amp; Roberts, R.G., 2009. Stochastic
modelling of multi-grain equivalent dose (De) distributions: Implications
for OSL dating of sediment mixtures. Quaternary Geochronology 4,
204-230.
</p>
<p>Cunningham, A.C. &amp; Wallinga, J., 2012. Realizing the
potential of fluvial archives using robust OSL chronologies. Quaternary
Geochronology 12, 98-106.
</p>
<p>Rodnight, H., Duller, G.A.T., Wintle, A.G. &amp;
Tooth, S., 2006. Assessing the reproducibility and accuracy of optical
dating of fluvial deposits.  Quaternary Geochronology 1, 109-120.
</p>
<p>Rodnight, H. 2008. How many equivalent dose values are needed to obtain a
reproducible distribution?. Ancient TL 26, 3-10.
</p>


<h3>See Also</h3>

<p><a href="../../Luminescence/help/calc_CentralDose.html">calc_CentralDose</a>, <a href="../../Luminescence/help/calc_CommonDose.html">calc_CommonDose</a>,
<a href="../../Luminescence/help/calc_FuchsLang2001.html">calc_FuchsLang2001</a>, <a href="../../Luminescence/help/calc_MinDose.html">calc_MinDose</a>
</p>


<h3>Examples</h3>

<pre>

## load example data
data(ExampleData.DeValues, envir = environment())

## (1) apply the finite mixture model
## NOTE: the data set is not suitable for the finite mixture model,
## which is why a very small sigmab is necessary
calc_FiniteMixture(ExampleData.DeValues$CA1,
                   sigmab = 0.2, n.components = 2,
                   grain.probability = TRUE)

## (2) repeat the finite mixture model for 2, 3 and 4 maximum number of fitted
## components and save results
## NOTE: The following example is computationally intensive. Please un-comment
## the following lines to make the example work.
FMM&lt;- calc_FiniteMixture(ExampleData.DeValues$CA1,
                         sigmab = 0.2, n.components = c(2:4),
                         pdf.weight = TRUE, dose.scale = c(0, 100))

## show structure of the results
FMM

## show the results on equivalent dose, standard error and proportion of
## fitted components
get_RLum(object = FMM, data.object = "components")

</pre>

<hr /><div style="text-align: center;">[Package <em>Luminescence</em> version 0.9.15 <a href="00Index.html">Index</a>]</div>
</div></body></html>

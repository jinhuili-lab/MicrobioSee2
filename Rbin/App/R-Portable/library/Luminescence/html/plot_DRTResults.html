<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Visualise dose recovery test results</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for plot_DRTResults {Luminescence}"><tr><td>plot_DRTResults {Luminescence}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Visualise dose recovery test results</h2>

<h3>Description</h3>

<p>The function provides a standardised plot output for dose recovery test
measurements.
</p>


<h3>Usage</h3>

<pre>
plot_DRTResults(
  values,
  given.dose = NULL,
  error.range = 10,
  preheat,
  boxplot = FALSE,
  mtext,
  summary,
  summary.pos,
  legend,
  legend.pos,
  par.local = TRUE,
  na.rm = FALSE,
  ...
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>values</code></td>
<td>
<p><a href="../../Luminescence/help/RLum.Results-class.html">RLum.Results</a> or <a href="../../base/html/data.frame.html">data.frame</a> (<strong>required</strong>):
input values containing at least De and De error. To plot
more than one data set in one figure, a <code>list</code> of the individual data
sets must be provided (e.g. <code>list(dataset.1, dataset.2)</code>).</p>
</td></tr>
<tr valign="top"><td><code>given.dose</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<em>optional</em>):
given dose used for the dose recovery test to normalise data.
If only one given dose is provided this given dose is valid for all input
data sets (i.e., <code>values</code> is a list).  Otherwise a given dose for each input
data set has to be provided (e.g., <code>given.dose = c(100,200)</code>).
If <code>given.dose</code> in <code>NULL</code> the values are plotted without normalisation
(might be useful for preheat plateau tests).
<strong>Note:</strong> Unit has to be the same as from the input values (e.g., Seconds or
Gray).</p>
</td></tr>
<tr valign="top"><td><code>error.range</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a>:
symmetric error range in percent will be shown as dashed lines in the plot.
Set <code>error.range</code> to 0 to void plotting of error ranges.</p>
</td></tr>
<tr valign="top"><td><code>preheat</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a>:
optional vector of preheat temperatures to be used for grouping the De values.
If specified, the temperatures are assigned to the x-axis.</p>
</td></tr>
<tr valign="top"><td><code>boxplot</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a>:
optionally plot values, that are grouped by preheat temperature as boxplots.
Only possible when <code>preheat</code> vector is specified.</p>
</td></tr>
<tr valign="top"><td><code>mtext</code></td>
<td>
<p><a href="../../base/html/character.html">character</a>:
additional text below the plot title.</p>
</td></tr>
<tr valign="top"><td><code>summary</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> (<em>optional</em>):
adds numerical output to the plot.  Can be one or more out of:
</p>

<ul>
<li> <p><code>"n"</code> (number of samples),
</p>
</li>
<li> <p><code>"mean"</code> (mean De value),
</p>
</li>
<li> <p><code>"weighted$mean"</code> (error-weighted mean),
</p>
</li>
<li> <p><code>"median"</code> (median of the De values),
</p>
</li>
<li> <p><code>"sd.rel"</code> (relative standard deviation in percent),
</p>
</li>
<li> <p><code>"sd.abs"</code> (absolute standard deviation),
</p>
</li>
<li> <p><code>"se.rel"</code> (relative standard error) and
</p>
</li>
<li> <p><code>"se.abs"</code> (absolute standard error)
</p>
</li></ul>

<p>and all other measures returned by the function <a href="../../Luminescence/help/calc_Statistics.html">calc_Statistics</a>.</p>
</td></tr>
<tr valign="top"><td><code>summary.pos</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> or <a href="../../base/html/character.html">character</a> (<em>with default</em>):
optional position coordinates or keyword (e.g. <code>"topright"</code>)
for the statistical summary. Alternatively, the keyword <code>"sub"</code> may be
specified to place the summary below the plot header. However, this latter
option in only possible if <code>mtext</code> is not used.</p>
</td></tr>
<tr valign="top"><td><code>legend</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> vector (<em>optional</em>):
legend content to be added to the plot.</p>
</td></tr>
<tr valign="top"><td><code>legend.pos</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> or <a href="../../base/html/character.html">character</a> (<em>with default</em>):
optional position coordinates or keyword (e.g. <code>"topright"</code>) for the
legend to be plotted.</p>
</td></tr>
<tr valign="top"><td><code>par.local</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
use local graphical parameters for plotting, e.g. the plot is shown in one
column and one row. If <code>par.local = FALSE</code>, global parameters are inherited,
i.e. parameters provided via <code>par()</code> work</p>
</td></tr>
<tr valign="top"><td><code>na.rm</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a>: indicating whether <code>NA</code> values are
removed before plotting from the input data set</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments and graphical parameters passed to <a href="../../graphics/html/plot.default.html">plot</a>, supported are:
<code>xlab</code>, <code>ylab</code>, <code>xlim</code>, <code>ylim</code>, <code>main</code>, <code>cex</code>, <code>las</code> and 'pch&ldquo;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Procedure to test the accuracy of a measurement protocol to reliably
determine the dose of a specific sample. Here, the natural signal is erased
and a known laboratory dose administered which is treated as unknown. Then
the De measurement is carried out and the degree of congruence between
administered and recovered dose is a measure of the protocol's accuracy for
this sample.<br />
In the plot the normalised De is shown on the y-axis, i.e. obtained De/Given Dose.
</p>


<h3>Value</h3>

<p>A plot is returned.
</p>


<h3>Function version</h3>

<p>0.1.13
</p>


<h3>How to cite</h3>

<p>Kreutzer, S., Dietze, M., 2021. plot_DRTResults(): Visualise dose recovery test results. Function version 0.1.13. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., 2021. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.15. https://CRAN.R-project.org/package=Luminescence
</p>


<h3>Note</h3>

<p>Further data and plot arguments can be added by using the appropriate R
commands.
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, Geography &amp; Earth Sciences, Aberystwyth University (United Kingdom)<br />
Michael Dietze, GFZ Potsdam (Germany)
, RLum Developer Team</p>


<h3>References</h3>

<p>Wintle, A.G., Murray, A.S., 2006. A review of quartz optically
stimulated luminescence characteristics and their relevance in
single-aliquot regeneration dating protocols. Radiation Measurements, 41,
369-391.
</p>


<h3>See Also</h3>

<p><a href="../../graphics/html/plot.default.html">plot</a>
</p>


<h3>Examples</h3>

<pre>

## read example data set and misapply them for this plot type
data(ExampleData.DeValues, envir = environment())

## plot values
plot_DRTResults(values = ExampleData.DeValues$BT998[7:11,],
given.dose = 2800, mtext = "Example data")

## plot values with legend
plot_DRTResults(values = ExampleData.DeValues$BT998[7:11,],
                given.dose = 2800,
                legend = "Test data set")

## create and plot two subsets with randomised values
x.1 &lt;- ExampleData.DeValues$BT998[7:11,]
x.2 &lt;- ExampleData.DeValues$BT998[7:11,] * c(runif(5, 0.9, 1.1), 1)

plot_DRTResults(values = list(x.1, x.2),
                given.dose = 2800)

## some more user-defined plot parameters
plot_DRTResults(values = list(x.1, x.2),
                given.dose = 2800,
                pch = c(2, 5),
                col = c("orange", "blue"),
                xlim = c(0, 8),
                ylim = c(0.85, 1.15),
                xlab = "Sample aliquot")

## plot the data with user-defined statistical measures as legend
plot_DRTResults(values = list(x.1, x.2),
                given.dose = 2800,
                summary = c("n", "mean.weighted", "sd"))

## plot the data with user-defined statistical measures as sub-header
plot_DRTResults(values = list(x.1, x.2),
                given.dose = 2800,
                summary = c("n", "mean.weighted", "sd"),
                summary.pos = "sub")

## plot the data grouped by preheat temperatures
plot_DRTResults(values = ExampleData.DeValues$BT998[7:11,],
                given.dose = 2800,
                preheat = c(200, 200, 200, 240, 240))
## read example data set and misapply them for this plot type
data(ExampleData.DeValues, envir = environment())

## plot values
plot_DRTResults(values = ExampleData.DeValues$BT998[7:11,],
                given.dose = 2800, mtext = "Example data")
## plot two data sets grouped by preheat temperatures
plot_DRTResults(values = list(x.1, x.2),
                given.dose = 2800,
                preheat = c(200, 200, 200, 240, 240))

## plot the data grouped by preheat temperatures as boxplots
plot_DRTResults(values = ExampleData.DeValues$BT998[7:11,],
                given.dose = 2800,
                preheat = c(200, 200, 200, 240, 240),
                boxplot = TRUE)

</pre>

<hr /><div style="text-align: center;">[Package <em>Luminescence</em> version 0.9.15 <a href="00Index.html">Index</a>]</div>
</div></body></html>

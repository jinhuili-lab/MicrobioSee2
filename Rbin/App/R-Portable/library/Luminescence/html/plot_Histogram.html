<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Plot a histogram with separate error plot</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for plot_Histogram {Luminescence}"><tr><td>plot_Histogram {Luminescence}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Plot a histogram with separate error plot</h2>

<h3>Description</h3>

<p>Function plots a predefined histogram with an accompanying error plot as
suggested by Rex Galbraith at the UK LED in Oxford 2010.
</p>


<h3>Usage</h3>

<pre>
plot_Histogram(
  data,
  na.rm = TRUE,
  mtext,
  cex.global,
  se,
  rug,
  normal_curve,
  summary,
  summary.pos,
  colour,
  interactive = FALSE,
  ...
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
<p><a href="../../base/html/data.frame.html">data.frame</a> or <a href="../../Luminescence/help/RLum.Results-class.html">RLum.Results</a> object (<strong>required</strong>):
for <code>data.frame</code>: two columns: De (<code>data[,1]</code>) and De error (<code>data[,2]</code>)</p>
</td></tr>
<tr valign="top"><td><code>na.rm</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
excludes <code>NA</code> values from the data set prior to any further operations.</p>
</td></tr>
<tr valign="top"><td><code>mtext</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> (<em>optional</em>):
further sample information (<a href="../../graphics/html/mtext.html">mtext</a>).</p>
</td></tr>
<tr valign="top"><td><code>cex.global</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<em>with default</em>):
global scaling factor.</p>
</td></tr>
<tr valign="top"><td><code>se</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>optional</em>):
plots standard error points over the histogram, default is <code>FALSE</code>.</p>
</td></tr>
<tr valign="top"><td><code>rug</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>optional</em>):
adds rugs to the histogram, default is <code>TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>normal_curve</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
adds a normal curve to the histogram. Mean and standard deviation are calculated from the
input data. More see details section.</p>
</td></tr>
<tr valign="top"><td><code>summary</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> (<em>optional</em>):
add statistic measures of centrality and dispersion to the plot.
Can be one or more of several keywords. See details for available keywords.</p>
</td></tr>
<tr valign="top"><td><code>summary.pos</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> or <a href="../../base/html/character.html">character</a> (<em>with default</em>):
optional position coordinates or keyword (e.g. <code>"topright"</code>)
for the statistical summary. Alternatively, the keyword <code>"sub"</code> may be
specified to place the summary below the plot header. However, this latter
option in only possible if <code>mtext</code> is not used. In case of coordinate
specification, y-coordinate refers to the right y-axis.</p>
</td></tr>
<tr valign="top"><td><code>colour</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> or <a href="../../base/html/character.html">character</a> (<em>with default</em>):
optional vector of length 4 which specifies the colours of the following
plot items in exactly this order: histogram bars, rug lines, normal
distribution curve and standard error points
(e.g., <code>c("grey", "black", "red", "grey")</code>).</p>
</td></tr>
<tr valign="top"><td><code>interactive</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
create an interactive histogram plot (requires the 'plotly' package)</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments and graphical parameters passed to <a href="../../graphics/html/plot.default.html">plot</a> or
<a href="../../graphics/html/hist.html">hist</a>. If y-axis labels are provided, these must be specified as a vector
of length 2 since the plot features two axes
(e.g. <code>ylab = c("axis label 1", "axis label 2")</code>). Y-axes limits
(<code>ylim</code>) must be provided as vector of length four, with the first two
elements specifying the left axes limits and the latter two elements giving
the right axis limits.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the normal curve is added, the y-axis in the histogram will show the
probability density.
</p>
<p>A statistic summary, i.e. a collection of statistic measures of
centrality and dispersion (and further measures) can be added by specifying
one or more of the following keywords:
</p>

<ul>
<li> <p><code>"n"</code> (number of samples),
</p>
</li>
<li> <p><code>"mean"</code> (mean De value),
</p>
</li>
<li> <p><code>"mean.weighted"</code> (error-weighted mean),
</p>
</li>
<li> <p><code>"median"</code> (median of the De values),
</p>
</li>
<li> <p><code>"sdrel"</code> (relative standard deviation in percent),
</p>
</li>
<li> <p><code>"sdrel.weighted"</code> (error-weighted relative standard deviation in percent),
</p>
</li>
<li> <p><code>"sdabs"</code> (absolute standard deviation),
</p>
</li>
<li> <p><code>"sdabs.weighted"</code> (error-weighted absolute standard deviation),
</p>
</li>
<li> <p><code>"serel"</code> (relative standard error),
</p>
</li>
<li> <p><code>"serel.weighted"</code> (error-weighted relative standard error),
</p>
</li>
<li> <p><code>"seabs"</code> (absolute standard error),
</p>
</li>
<li> <p><code>"seabs.weighted"</code> (error-weighted absolute standard error),
</p>
</li>
<li> <p><code>"kurtosis"</code> (kurtosis) and
</p>
</li>
<li> <p><code>"skewness"</code> (skewness).
</p>
</li></ul>



<h3>Function version</h3>

<p>0.4.5
</p>


<h3>How to cite</h3>

<p>Dietze, M., Kreutzer, S., 2021. plot_Histogram(): Plot a histogram with separate error plot. Function version 0.4.5. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., 2021. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.15. https://CRAN.R-project.org/package=Luminescence
</p>


<h3>Note</h3>

<p>The input data is not restricted to a special type.
</p>


<h3>Author(s)</h3>

<p>Michael Dietze, GFZ Potsdam (Germany)<br />
Sebastian Kreutzer, Geography &amp; Earth Sciences, Aberystwyth University (United Kingdom)
, RLum Developer Team</p>


<h3>See Also</h3>

<p><a href="../../graphics/html/hist.html">hist</a>, <a href="../../graphics/html/plot.default.html">plot</a>
</p>


<h3>Examples</h3>

<pre>

## load data
data(ExampleData.DeValues, envir = environment())
ExampleData.DeValues &lt;-
  Second2Gray(ExampleData.DeValues$BT998, dose.rate = c(0.0438,0.0019))

## plot histogram the easiest way
plot_Histogram(ExampleData.DeValues)

## plot histogram with some more modifications
plot_Histogram(ExampleData.DeValues,
               rug = TRUE,
               normal_curve = TRUE,
               cex.global = 0.9,
               pch = 2,
               colour = c("grey", "black", "blue", "green"),
               summary = c("n", "mean", "sdrel"),
               summary.pos = "topleft",
               main = "Histogram of De-values",
               mtext = "Example data set",
               ylab = c(expression(paste(D[e], " distribution")),
                        "Standard error"),
               xlim = c(100, 250),
               ylim = c(0, 0.1, 5, 20))


</pre>

<hr /><div style="text-align: center;">[Package <em>Luminescence</em> version 0.9.15 <a href="00Index.html">Index</a>]</div>
</div></body></html>

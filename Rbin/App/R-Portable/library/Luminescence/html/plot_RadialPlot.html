<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Function to create a Radial Plot</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for plot_RadialPlot {Luminescence}"><tr><td>plot_RadialPlot {Luminescence}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Function to create a Radial Plot</h2>

<h3>Description</h3>

<p>A Galbraith's radial plot is produced on a logarithmic or a linear scale.
</p>


<h3>Usage</h3>

<pre>
plot_RadialPlot(
  data,
  na.rm = TRUE,
  log.z = TRUE,
  central.value,
  centrality = "mean.weighted",
  mtext,
  summary,
  summary.pos,
  legend,
  legend.pos,
  stats,
  rug = FALSE,
  plot.ratio,
  bar.col,
  y.ticks = TRUE,
  grid.col,
  line,
  line.col,
  line.label,
  output = FALSE,
  ...
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
<p><a href="../../base/html/data.frame.html">data.frame</a> or <a href="../../Luminescence/help/RLum.Results-class.html">RLum.Results</a> object (<strong>required</strong>):
for <code>data.frame</code> two columns: De (<code>data[,1]</code>) and De error (<code>data[,2]</code>).
To plot several data sets in one plot, the data sets must be provided as
<code>list</code>, e.g. <code>list(data.1, data.2)</code>.</p>
</td></tr>
<tr valign="top"><td><code>na.rm</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
excludes <code>NA</code> values from the data set prior to any further operations.</p>
</td></tr>
<tr valign="top"><td><code>log.z</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
Option to display the z-axis in logarithmic scale. Default is <code>TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>central.value</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a>:
User-defined central value, primarily used for horizontal centring
of the z-axis.</p>
</td></tr>
<tr valign="top"><td><code>centrality</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> or <a href="../../base/html/numeric.html">numeric</a> (<em>with default</em>):
measure of centrality, used for automatically centring the plot and drawing
the central line. Can either be one out of
</p>

<ul>
<li> <p><code>"mean"</code>,
</p>
</li>
<li> <p><code>"median"</code>,
</p>
</li>
<li> <p><code>"mean.weighted"</code> and
</p>
</li>
<li> <p><code>"median.weighted"</code> or a
</p>
</li>
<li><p> numeric value used for the standardisation.
</p>
</li></ul>
</td></tr>
<tr valign="top"><td><code>mtext</code></td>
<td>
<p><a href="../../base/html/character.html">character</a>:
additional text below the plot title.</p>
</td></tr>
<tr valign="top"><td><code>summary</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> (<em>optional</em>):
add statistic measures of centrality and dispersion to the plot.
Can be one or more of several keywords. See details for available keywords.</p>
</td></tr>
<tr valign="top"><td><code>summary.pos</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> or <a href="../../base/html/character.html">character</a> (<em>with default</em>):
optional position coordinates or keyword (e.g. <code>"topright"</code>)
for the statistical summary. Alternatively, the keyword <code>"sub"</code> may be
specified to place the summary below the plot header. However, this latter
option is only possible if <code>mtext</code> is not used.</p>
</td></tr>
<tr valign="top"><td><code>legend</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> vector (<em>optional</em>):
legend content to be added to the plot.</p>
</td></tr>
<tr valign="top"><td><code>legend.pos</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> or <a href="../../base/html/character.html">character</a> (with
default): optional position coordinates or keyword (e.g. <code>"topright"</code>)
for the legend to be plotted.</p>
</td></tr>
<tr valign="top"><td><code>stats</code></td>
<td>
<p><a href="../../base/html/character.html">character</a>: additional labels of statistically
important values in the plot. One or more out of the following:
</p>

<ul>
<li> <p><code>"min"</code>,
</p>
</li>
<li> <p><code>"max"</code>,
</p>
</li>
<li> <p><code>"median"</code>.
</p>
</li></ul>
</td></tr>
<tr valign="top"><td><code>rug</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a>:
Option to add a rug to the z-scale, to indicate the location of individual values</p>
</td></tr>
<tr valign="top"><td><code>plot.ratio</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a>:
User-defined plot area ratio (i.e. curvature of the z-axis). If omitted,
the default value (<code>4.5/5.5</code>) is used and modified automatically to optimise
the z-axis curvature. The parameter should be decreased when data points
are plotted outside the z-axis or when the z-axis gets too elliptic.</p>
</td></tr>
<tr valign="top"><td><code>bar.col</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> or <a href="../../base/html/numeric.html">numeric</a> (<em>with default</em>):
colour of the bar showing the 2-sigma range around the central
value. To disable the bar, use <code>"none"</code>. Default is <code>"grey"</code>.</p>
</td></tr>
<tr valign="top"><td><code>y.ticks</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a>:
Option to hide y-axis labels. Useful for data with small scatter.</p>
</td></tr>
<tr valign="top"><td><code>grid.col</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> or <a href="../../base/html/numeric.html">numeric</a> (<em>with default</em>):
colour of the grid lines (originating at <code style="white-space: pre;">[0,0]</code> and stretching to
the z-scale). To disable grid lines, use <code>"none"</code>. Default is <code>"grey"</code>.</p>
</td></tr>
<tr valign="top"><td><code>line</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a>:
numeric values of the additional lines to be added.</p>
</td></tr>
<tr valign="top"><td><code>line.col</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> or <a href="../../base/html/numeric.html">numeric</a>:
colour of the additional lines.</p>
</td></tr>
<tr valign="top"><td><code>line.label</code></td>
<td>
<p><a href="../../base/html/character.html">character</a>:
labels for the additional lines.</p>
</td></tr>
<tr valign="top"><td><code>output</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a>:
Optional output of numerical plot parameters. These can be useful to
reproduce similar plots. Default is <code>FALSE</code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Further plot arguments to pass. <code>xlab</code> must be a vector of
length 2, specifying the upper and lower x-axes labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details and the theoretical background of the radial plot are given in the
cited literature. This function is based on an S script of Rex Galbraith. To
reduce the manual adjustments, the function has been rewritten. Thanks to
Rex Galbraith for useful comments on this function. <br />
Plotting can be disabled by adding the argument <code>plot = "FALSE"</code>, e.g.
to return only numeric plot output.
</p>
<p>Earlier versions of the Radial Plot in this package had the 2-sigma-bar
drawn onto the z-axis. However, this might have caused misunderstanding in
that the 2-sigma range may also refer to the z-scale, which it does not!
Rather it applies only to the x-y-coordinate system (standardised error vs.
precision). A spread in doses or ages must be drawn as lines originating at
zero precision (x0) and zero standardised estimate (y0). Such a range may be
drawn by adding lines to the radial plot ( <code>line</code>, <code>line.col</code>,
<code>line.label</code>, cf. examples).
</p>
<p>A statistic summary, i.e. a collection of statistic measures of
centrality and dispersion (and further measures) can be added by specifying
one or more of the following keywords:
</p>

<ul>
<li> <p><code>"n"</code> (number of samples),
</p>
</li>
<li> <p><code>"mean"</code> (mean De value),
</p>
</li>
<li> <p><code>"mean.weighted"</code> (error-weighted mean),
</p>
</li>
<li> <p><code>"median"</code> (median of the De values),
</p>
</li>
<li> <p><code>"sdrel"</code> (relative standard deviation in percent),
</p>
</li>
<li> <p><code>"sdrel.weighted"</code> (error-weighted relative standard deviation in percent),
</p>
</li>
<li> <p><code>"sdabs"</code> (absolute standard deviation),
</p>
</li>
<li> <p><code>"sdabs.weighted"</code> (error-weighted absolute standard deviation),
</p>
</li>
<li> <p><code>"serel"</code> (relative standard error),
</p>
</li>
<li> <p><code>"serel.weighted"</code> (error-weighted relative standard error),
</p>
</li>
<li> <p><code>"seabs"</code> (absolute standard error),
</p>
</li>
<li> <p><code>"seabs.weighted"</code> (error-weighted absolute standard error),
</p>
</li>
<li> <p><code>"in.2s"</code> (percent of samples in 2-sigma range),
</p>
</li>
<li> <p><code>"kurtosis"</code> (kurtosis) and
</p>
</li>
<li> <p><code>"skewness"</code> (skewness).
</p>
</li></ul>



<h3>Value</h3>

<p>Returns a plot object.
</p>


<h3>Function version</h3>

<p>0.5.5
</p>


<h3>How to cite</h3>

<p>Dietze, M., Kreutzer, S., 2021. plot_RadialPlot(): Function to create a Radial Plot. Function version 0.5.5. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., 2021. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.15. https://CRAN.R-project.org/package=Luminescence
</p>


<h3>Author(s)</h3>

<p>Michael Dietze, GFZ Potsdam (Germany)<br />
Sebastian Kreutzer, Geography &amp; Earth Sciences, Aberystwyth University (United Kingdom)<br />
Based on a rewritten S script of Rex Galbraith, 2010
, RLum Developer Team</p>


<h3>References</h3>

<p>Galbraith, R.F., 1988. Graphical Display of Estimates Having
Differing Standard Errors. Technometrics, 30 (3), 271-281.
</p>
<p>Galbraith, R.F., 1990. The radial plot: Graphical assessment of spread in
ages. International Journal of Radiation Applications and Instrumentation.
Part D. Nuclear Tracks and Radiation Measurements, 17 (3), 207-214.
</p>
<p>Galbraith, R. &amp; Green, P., 1990. Estimating the component ages in a finite
mixture. International Journal of Radiation Applications and
Instrumentation. Part D. Nuclear Tracks and Radiation Measurements, 17 (3)
197-206.
</p>
<p>Galbraith, R.F. &amp; Laslett, G.M., 1993. Statistical models for mixed fission
track ages. Nuclear Tracks And Radiation Measurements, 21 (4), 459-470.
</p>
<p>Galbraith, R.F., 1994. Some Applications of Radial Plots. Journal of the
American Statistical Association, 89 (428), 1232-1242.
</p>
<p>Galbraith, R.F., 2010. On plotting OSL equivalent doses. Ancient TL, 28 (1),
1-10.
</p>
<p>Galbraith, R.F. &amp; Roberts, R.G., 2012. Statistical aspects of equivalent
dose and error calculation and display in OSL dating: An overview and some
recommendations. Quaternary Geochronology, 11, 1-27.
</p>


<h3>See Also</h3>

<p><a href="../../graphics/html/plot.default.html">plot</a>, <a href="../../Luminescence/help/plot_KDE.html">plot_KDE</a>, <a href="../../Luminescence/help/plot_Histogram.html">plot_Histogram</a>
</p>


<h3>Examples</h3>

<pre>

## load example data
data(ExampleData.DeValues, envir = environment())
ExampleData.DeValues &lt;- Second2Gray(ExampleData.DeValues$BT998, c(0.0438,0.0019))

## plot the example data straightforward
plot_RadialPlot(data = ExampleData.DeValues)

## now with linear z-scale
plot_RadialPlot(data = ExampleData.DeValues,
                log.z = FALSE)

## now with output of the plot parameters
plot1 &lt;- plot_RadialPlot(data = ExampleData.DeValues,
                         log.z = FALSE,
                         output = TRUE)
plot1
plot1$zlim

## now with adjusted z-scale limits
plot_RadialPlot(data = ExampleData.DeValues,
               log.z = FALSE,
               zlim = c(100, 200))

## now the two plots with serious but seasonally changing fun
#plot_RadialPlot(data = data.3, fun = TRUE)

## now with user-defined central value, in log-scale again
plot_RadialPlot(data = ExampleData.DeValues,
                central.value = 150)

## now with a rug, indicating individual De values at the z-scale
plot_RadialPlot(data = ExampleData.DeValues,
                rug = TRUE)

## now with legend, colour, different points and smaller scale
plot_RadialPlot(data = ExampleData.DeValues,
                legend.text = "Sample 1",
                col = "tomato4",
                bar.col = "peachpuff",
                pch = "R",
                cex = 0.8)

## now without 2-sigma bar, y-axis, grid lines and central value line
plot_RadialPlot(data = ExampleData.DeValues,
                bar.col = "none",
                grid.col = "none",
                y.ticks = FALSE,
                lwd = 0)

## now with user-defined axes labels
plot_RadialPlot(data = ExampleData.DeValues,
                xlab = c("Data error (%)",
                         "Data precision"),
                ylab = "Scatter",
                zlab = "Equivalent dose [Gy]")

## now with minimum, maximum and median value indicated
plot_RadialPlot(data = ExampleData.DeValues,
                central.value = 150,
                stats = c("min", "max", "median"))

## now with a brief statistical summary
plot_RadialPlot(data = ExampleData.DeValues,
                summary = c("n", "in.2s"))

## now with another statistical summary as subheader
plot_RadialPlot(data = ExampleData.DeValues,
                summary = c("mean.weighted", "median"),
                summary.pos = "sub")

## now the data set is split into sub-groups, one is manipulated
data.1 &lt;- ExampleData.DeValues[1:15,]
data.2 &lt;- ExampleData.DeValues[16:25,] * 1.3

## now a common dataset is created from the two subgroups
data.3 &lt;- list(data.1, data.2)

## now the two data sets are plotted in one plot
plot_RadialPlot(data = data.3)

## now with some graphical modification
plot_RadialPlot(data = data.3,
                col = c("darkblue", "darkgreen"),
                bar.col = c("lightblue", "lightgreen"),
                pch = c(2, 6),
                summary = c("n", "in.2s"),
                summary.pos = "sub",
                legend = c("Sample 1", "Sample 2"))

</pre>

<hr /><div style="text-align: center;">[Package <em>Luminescence</em> version 0.9.15 <a href="00Index.html">Index</a>]</div>
</div></body></html>

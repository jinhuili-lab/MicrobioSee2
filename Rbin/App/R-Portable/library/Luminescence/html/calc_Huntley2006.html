<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Apply the Huntley (2006) model</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for calc_Huntley2006 {Luminescence}"><tr><td>calc_Huntley2006 {Luminescence}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Apply the Huntley (2006) model</h2>

<h3>Description</h3>

<p>A function to calculate the expected sample specific fraction of saturation
based on the model of Huntley (2006) using the approach as implemented
in Kars et al. (2008) or Guralnik et al. (2015).
</p>


<h3>Usage</h3>

<pre>
calc_Huntley2006(
  data,
  LnTn = NULL,
  rhop,
  ddot,
  readerDdot,
  normalise = TRUE,
  fit.method = c("EXP", "GOK")[1],
  lower.bounds = c(-Inf, -Inf, -Inf),
  summary = TRUE,
  plot = TRUE,
  ...
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
<p><a href="../../base/html/data.frame.html">data.frame</a> (<strong>required</strong>):
A <code>data.frame</code> with one of the following structures:
</p>

<ul>
<li><p> A <strong>three column</strong> data frame with numeric values on a) dose (s), b) <code>LxTx</code> and
c) <code>LxTx</code> error.
</p>
</li>
<li><p> If a <strong>two column</strong> data frame is provided it is automatically
assumed that errors on <code>LxTx</code> are missing. A third column will be attached
with an arbitrary 5 \
</p>
</li>
<li><p> Can also be a <strong>wide table</strong>, i.e. a <a href="../../base/html/data.frame.html">data.frame</a> with a number of columns divisible by 3
and where each triplet has the aforementioned column structure.
</p>
</li></ul>
<pre>                        (optional)
     | dose (s)| LxTx | LxTx error |
     |  [ ,1]  | [ ,2]|    [ ,3]   |
     |---------|------|------------|
[1, ]|  0      | LnTn | LnTn error | (optional, see arg 'LnTn')
[2, ]|  R1     | L1T1 | L1T1 error |
 ... |    ...  |  ... |     ...    |
[x, ]|  Rx     | LxTx | LxTx error |

</pre>
<p><strong>NOTE:</strong> The function assumes the first row of the function to be the
<code>Ln/Tn</code>-value. If you want to provide more than one <code>Ln/Tn</code>-value consider
using the argument <code>LnTn</code>.</p>
</td></tr>
<tr valign="top"><td><code>LnTn</code></td>
<td>
<p><a href="../../base/html/data.frame.html">data.frame</a> (<strong>optional</strong>):
This argument should <strong>only</strong> be used to provide more than one <code>Ln/Tn</code>-value.
It assumes a two column data frame with the following structure:</p>
<pre>     |  LnTn  |  LnTn error  |
     |  [ ,1] |      [ ,2]   |
     |--------|--------------|
[1, ]| LnTn_1 | LnTn_1 error |
[2, ]| LnTn_2 | LnTn_2 error |
 ... |   ...  |      ...     |
[x, ]| LnTn_x | LnTn_x error |
</pre>
<p>The function will calculate a <strong>mean</strong> <code>Ln/Tn</code>-value and uses either the
standard deviation or the highest individual error, whichever is larger. If
another mean value (e.g. a weighted mean or median) or error is preferred,
this value must be calculated beforehand and used in the first row in the
data frame for argument <code>data</code>.
</p>
<p><strong>NOTE:</strong> If you provide <code>LnTn</code>-values with this argument the data frame
for the <code>data</code>-argument <strong>must not</strong> contain any <code>LnTn</code>-values!</p>
</td></tr>
<tr valign="top"><td><code>rhop</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<strong>required</strong>):
The density of recombination centres (<i>&rho;</i>') and its error (see Huntley 2006),
given as numeric vector of length two. Note that <i>&rho;</i>' must <strong>not</strong> be
provided as the common logarithm. Example: <code>rhop = c(2.92e-06, 4.93e-07)</code>.</p>
</td></tr>
<tr valign="top"><td><code>ddot</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<strong>required</strong>):
Environmental dose rate and its error, given as a numeric vector of length two.
Expected unit: Gy/ka. Example: <code>ddot = c(3.7, 0.4)</code>.</p>
</td></tr>
<tr valign="top"><td><code>readerDdot</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<strong>required</strong>):
Dose rate of the irradiation source of the OSL reader and its error,
given as a numeric vector of length two.
Expected unit: Gy/s. Example: <code>readerDdot = c(0.08, 0.01)</code>.</p>
</td></tr>
<tr valign="top"><td><code>normalise</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
If <code>TRUE</code> (the default) all measured and computed LxTx values are
normalised by the pre-exponential factor A (see details).</p>
</td></tr>
<tr valign="top"><td><code>fit.method</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> (<em>with default</em>):
Fit function of the dose response curve. Can either be <code>EXP</code> (the default)
or <code>GOK</code>. Note that <code>EXP</code> (single saturating exponential) is the original
function the model after Huntley (2006) and Kars et al. (2008) was
designed to use. The use of a general-order kinetics function (<code>GOK</code>)
is an experimental adaption of the model and should be used
with great care.</p>
</td></tr>
<tr valign="top"><td><code>lower.bounds</code></td>
<td>
<p><a href="../../base/html/numeric.html">numeric</a> (<em>with default</em>):
Only applicable for <code>fit.method = 'GOK'</code>. A vector of length 3 that
contains the lower bound values for fitting the general-order kinetics
function using <a href="../../minpack.lm/help/nlsLM.html">minpack.lm::nlsLM</a>. In most cases, the default values
(c(<code style="white-space: pre;">-Inf, -Inf, -Inf</code>)) are appropriate for finding a best fit, but
sometimes it may be useful to restrict the lower bounds to e.g.
c(<code style="white-space: pre;">0, 0, 0</code>). The values of the vector are for parameters
<code>a</code>, <code>D0</code> and <code>c</code> in that particular order (see details in
<a href="../../Luminescence/help/plot_GrowthCurve.html">plot_GrowthCurve</a>).</p>
</td></tr>
<tr valign="top"><td><code>summary</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
If <code>TRUE</code> (the default) various parameters provided by the user
and calculated by the model are added as text on the right-hand side of the
plot.</p>
</td></tr>
<tr valign="top"><td><code>plot</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
enables/disables plot output.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Further parameters:
</p>

<ul>
<li> <p><code>verbose</code> <a href="../../base/html/logical.html">logical</a>: Show or hide console output
</p>
</li>
<li> <p><code>n.MC</code> <a href="../../base/html/numeric.html">numeric</a>: Number of Monte Carlo iterations (default = <code>100000</code>).
<strong>Note</strong> that it is generally advised to have a large number of Monte Carlo
iterations for the results to converge. Decreasing the number of iterations
will often result in unstable estimates.
</p>
</li></ul>

<p>All other arguments are passed to <a href="../../graphics/html/plot.default.html">plot</a> and <a href="../../Luminescence/help/plot_GrowthCurve.html">plot_GrowthCurve</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function applies the approach described in Kars et al. (2008) or Guralnik et al. (2015),
which are both developed from the model of Huntley (2006) to calculate the expected sample
specific fraction of saturation of a feldspar and also to calculate fading
corrected age using this model. <i>&rho;</i>' (<code>rhop</code>), the density of recombination
centres, is a crucial parameter of this model and must be determined
separately from a fading measurement. The function <a href="../../Luminescence/help/analyse_FadingMeasurement.html">analyse_FadingMeasurement</a>
can be used to calculate the sample specific <i>&rho;</i>' value.
</p>
<p><strong>Kars et al. (2008) - Single saturating exponential</strong>
</p>
<p>To apply the approach after Kars et al. (2008) use <code>fit.method = "EXP"</code>.
</p>
<p>Firstly, the unfaded D0 value is determined through applying equation 5 of
Kars et al. (2008) to the measured LxTx data as a function of irradiation
time, and fitting the data with a single saturating exponential of the form:
</p>
<p style="text-align: center;"><i>LxTx(t*) = A x &phi;(t*) x (1 - exp(-(t* / D0)))</i></p>

<p>where
</p>
<p style="text-align: center;"><i>&phi;(t*) = exp(-&rho;' x ln(1.8 x s_tilde x t*)^3)</i></p>

<p>after King et al. (2016) where <code>A</code> is a pre-exponential factor,
<code style="white-space: pre;">t*</code> (s) is the irradiation time, starting at the mid-point of
irradiation (Auclair et al. 2003) and <code>s_tilde</code> (3x10^15 s^-1) is the athermal
frequency factor after Huntley (2006). <br />
</p>
<p>Using fit parameters <code>A</code> and <code>D0</code>, the function then computes a natural dose
response curve using the environmental dose rate, <code>D_dot</code> (Gy/s) and equations
<code style="white-space: pre;">[1]</code> and <code style="white-space: pre;">[2]</code>. Computed LxTx values are then fitted using the
<a href="../../Luminescence/help/plot_GrowthCurve.html">plot_GrowthCurve</a> function and the laboratory measured LnTn can then
be interpolated onto this curve to determine the fading corrected
De value, from which the fading corrected age is calculated.
</p>
<p><strong>Guralnik et al. (2015) - General-order kinetics</strong>
</p>
<p>To apply the approach after Guralnik et al. (2015) use <code>fit.method = "GOK"</code>.
</p>
<p>The approach of Guralnik et al. (2015) is very similar to that of
Kars et al. (2008), but instead of using a single saturating exponential
the model fits a general-order kinetics function of the form:
</p>
<p style="text-align: center;"><i>LxTx(t*) = A x &phi;(t*) x (1-(1+(1/D0) x t* x c)^(-1/c))</i></p>

<p>where <code>A</code>, <i>&phi;</i>, <code style="white-space: pre;">t*</code> and <code>D0</code> are the same as above and <code>c</code> is a
dimensionless kinetic order modifier (cf. equation 10 in
Guralnik et al., 2015).
</p>
<p><strong>Level of saturation</strong>
</p>
<p>The <code>calc_Huntley2006</code> function also calculates the level of saturation (n/N)
and the field saturation (i.e. athermal steady state, (n/N)_SS) value for
the sample under investigation using the sample specific <i>&rho;</i>',
unfaded <code>D0</code> and <code>D_dot</code> values, following the approach of Kars et al. (2008).
</p>
<p><strong>Uncertainties</strong>
</p>
<p>Uncertainties are reported at 1 sigma and are assumed to be normally
distributed and are estimated using Monte-Carlo re-sampling (<code>n.MC = 1000</code>)
of <i>&rho;</i>' and <code>LxTx</code> during dose response curve fitting, and of <i>&rho;</i>'
in the derivation of (n/N) and (n/N)_SS.
</p>
<p><strong>Age calculated from 2D0 of the simulated natural DRC</strong>
</p>
<p>In addition to the age calculated from the equivalent dose derived from
<code>Ln/Tn</code> projected on the simulated natural dose response curve (DRC), this function
also calculates an age from twice the characteristic saturation dose (<code>D0</code>)
of the simulated natural DRC. This can be a useful information for
(over)saturated samples (i.e., no intersect of <code>Ln/Tn</code> on the natural DRC)
to obtain at least a &quot;minimum age&quot; estimate of the sample. In the console
output this value is denoted by <em>&quot;Age @2D0 (ka):&quot;</em>.
</p>


<h3>Value</h3>

<p>An <a href="../../Luminescence/help/RLum.Results-class.html">RLum.Results</a> object is returned:
</p>
<p>Slot: <strong>@data</strong><br />
</p>

<table summary="Rd table">
<tr>
 <td style="text-align: left;">
<strong>OBJECT</strong> </td><td style="text-align: left;"> <strong>TYPE</strong> </td><td style="text-align: left;"> <strong>COMMENT</strong></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>results</code> </td><td style="text-align: left;"> <a href="../../base/html/data.frame.html">data.frame</a> </td><td style="text-align: left;"> results of the of Kars et al. 2008 model </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>data</code> </td><td style="text-align: left;"> <a href="../../base/html/data.frame.html">data.frame</a> </td><td style="text-align: left;"> original input data </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Ln</code> </td><td style="text-align: left;"> <a href="../../base/html/numeric.html">numeric</a> </td><td style="text-align: left;"> Ln and its error </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>LxTx_tables</code> </td><td style="text-align: left;"> <code>list</code> </td><td style="text-align: left;"> A <code>list</code> of <code>data.frames</code> containing data on dose,
LxTx and LxTx error for each of the dose response curves.
Note that these <strong>do not</strong> contain the natural Ln signal, which is provided separately. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>fits</code> </td><td style="text-align: left;"> <code>list</code> </td><td style="text-align: left;"> A <code>list</code> of <code>nls</code> objects produced by <a href="../../minpack.lm/help/nlsLM.html">minpack.lm::nlsLM</a> when fitting the dose response curves </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Slot: <strong>@info</strong><br />
</p>

<table summary="Rd table">
<tr>
 <td style="text-align: left;">
<strong>OBJECT</strong> </td><td style="text-align: left;"> <strong>TYPE</strong> </td><td style="text-align: left;"> <strong>COMMENT</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>call</code> </td><td style="text-align: left;"> <code>call</code> </td><td style="text-align: left;"> the original function call </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>args</code> </td><td style="text-align: left;"> <code>list</code> </td><td style="text-align: left;"> arguments of the original function call </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Function version</h3>

<p>0.4.1
</p>


<h3>How to cite</h3>

<p>King, G.E., Burow, C., 2021. calc_Huntley2006(): Apply the Huntley (2006) model. Function version 0.4.1. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., 2021. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.15. https://CRAN.R-project.org/package=Luminescence
</p>


<h3>Note</h3>

<p><strong>This function has BETA status and should not be used for publication work!</strong>
</p>


<h3>Author(s)</h3>

<p>Georgina E. King, University of Bern (Switzerland) <br />
Christoph Burow, University of Cologne (Germany)
, RLum Developer Team</p>


<h3>References</h3>

<p>Kars, R.H., Wallinga, J., Cohen, K.M., 2008. A new approach towards anomalous fading correction for feldspar
IRSL dating-tests on samples in field saturation. Radiation Measurements 43, 786-790. doi:10.1016/j.radmeas.2008.01.021
</p>
<p>Guralnik, B., Li, B., Jain, M., Chen, R., Paris, R.B., Murray, A.S., Li, S.-H., Pagonis, P.,
Herman, F., 2015. Radiation-induced growth and isothermal decay of infrared-stimulated luminescence
from feldspar. Radiation Measurements 81, 224-231.
</p>
<p>Huntley, D.J., 2006. An explanation of the power-law decay of luminescence.
Journal of Physics: Condensed Matter 18, 1359-1365. doi:10.1088/0953-8984/18/4/020
</p>
<p>King, G.E., Herman, F., Lambert, R., Valla, P.G., Guralnik, B., 2016.
Multi-OSL-thermochronometry of feldspar. Quaternary Geochronology 33, 76-87. doi:10.1016/j.quageo.2016.01.004
</p>
<p><strong>Further reading</strong>
</p>
<p>Morthekai, P., Jain, M., Cunha, P.P., Azevedo, J.M., Singhvi, A.K., 2011. An attempt to correct
for the fading in million year old basaltic rocks. Geochronometria 38(3), 223-230.
</p>


<h3>Examples</h3>

<pre>

## Load example data (sample UNIL/NB123, see ?ExampleData.Fading)
data("ExampleData.Fading", envir = environment())

## (1) Set all relevant parameters
# a. fading measurement data (IR50)
fading_data &lt;- ExampleData.Fading$fading.data$IR50

# b. Dose response curve data
data &lt;- ExampleData.Fading$equivalentDose.data$IR50

## (2) Define required function parameters
ddot &lt;- c(7.00, 0.004)
readerDdot &lt;- c(0.134, 0.0067)

# Analyse fading measurement and get an estimate of rho'.
# Note that the RLum.Results object can be directly used for further processing.
# The number of MC runs is reduced for this example
rhop &lt;- analyse_FadingMeasurement(fading_data, plot = TRUE, verbose = FALSE, n.MC = 10)

## (3) Apply the Kars et al. (2008) model to the data
kars &lt;- calc_Huntley2006(data = data,
                         rhop = rhop,
                         ddot = ddot,
                         readerDdot = readerDdot,
                         n.MC = 25)


## Not run: 
# You can also provide LnTn values separately via the 'LnTn' argument.
# Note, however, that the data frame for 'data' must then NOT contain
# a LnTn value. See argument descriptions!
LnTn &lt;- data.frame(LnTn = c(1.84833, 2.24833),
                   LnTn.error = c(0.17, 0.22))

LxTx &lt;- data[2:nrow(data), ]

kars &lt;- calc_Huntley2006(data = LxTx,
                      LnTn = LnTn,
                      rhop = rhop,
                      ddot = ddot,
                      readerDdot = readerDdot,
                      n.MC = 25)

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>Luminescence</em> version 0.9.15 <a href="00Index.html">Index</a>]</div>
</div></body></html>

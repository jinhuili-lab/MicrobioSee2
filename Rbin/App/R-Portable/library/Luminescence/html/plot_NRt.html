<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Visualise natural/regenerated signal ratios</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for plot_NRt {Luminescence}"><tr><td>plot_NRt {Luminescence}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Visualise natural/regenerated signal ratios</h2>

<h3>Description</h3>

<p>This function creates a Natural/Regenerated signal vs. time (NR(t)) plot
as shown in Steffen et al. 2009
</p>


<h3>Usage</h3>

<pre>
plot_NRt(
  data,
  log = FALSE,
  smooth = c("none", "spline", "rmean"),
  k = 3,
  legend = TRUE,
  legend.pos = "topright",
  ...
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
<p><a href="../../base/html/list.html">list</a>, <a href="../../base/html/data.frame.html">data.frame</a>, <a href="../../base/html/matrix.html">matrix</a> or <a href="../../Luminescence/help/RLum.Analysis-class.html">RLum.Analysis</a> (<strong>required</strong>):
X,Y data of measured values (time and counts). See details on individual data structure.</p>
</td></tr>
<tr valign="top"><td><code>log</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> (<em>optional</em>):
logarithmic axes (<code>c("x", "y", "xy")</code>).</p>
</td></tr>
<tr valign="top"><td><code>smooth</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> (<em>optional</em>):
apply data smoothing. Use <code>"rmean"</code> to calculate the rolling where <code>k</code>
determines the width of the rolling window (see <a href="../../data.table/html/froll.html">rollmean</a>). <code>"spline"</code>
applies a smoothing spline to each curve (see <a href="../../stats/html/smooth.spline.html">smooth.spline</a>)</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
<p><a href="../../base/html/integer.html">integer</a> (<em>with default</em>):
integer width of the rolling window.</p>
</td></tr>
<tr valign="top"><td><code>legend</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>with default</em>):
show or hide the plot legend.</p>
</td></tr>
<tr valign="top"><td><code>legend.pos</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> (<em>with default</em>):
keyword specifying the position of the legend (see <a href="../../graphics/html/legend.html">legend</a>).</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further parameters passed to <a href="../../graphics/html/plot.default.html">plot</a> (also see <a href="../../graphics/html/par.html">par</a>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function accepts the individual curve data in many different formats. If
<code>data</code> is a <code>list</code>, each element of the list must contain a two
column <code>data.frame</code> or <code>matrix</code> containing the <code>XY</code> data of the curves
(time and counts). Alternatively, the elements can be objects of class
<a href="../../Luminescence/help/RLum.Data.Curve-class.html">RLum.Data.Curve</a>.
</p>
<p>Input values can also be provided as a <code>data.frame</code> or <code>matrix</code> where
the first column contains the time values and each following column contains
the counts of each curve.
</p>


<h3>Value</h3>

<p>Returns a plot and <a href="../../Luminescence/help/RLum.Analysis-class.html">RLum.Analysis</a> object.
</p>


<h3>How to cite</h3>

<p>Burow, C., 2021. plot_NRt(): Visualise natural/regenerated signal ratios. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., 2021. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.15. https://CRAN.R-project.org/package=Luminescence
</p>


<h3>Author(s)</h3>

<p>Christoph Burow, University of Cologne (Germany)
, RLum Developer Team</p>


<h3>References</h3>

<p>Steffen, D., Preusser, F., Schlunegger, F., 2009. OSL quartz underestimation due to
unstable signal components. Quaternary Geochronology, 4, 353-362.
</p>


<h3>See Also</h3>

<p><a href="../../graphics/html/plot.default.html">plot</a>
</p>


<h3>Examples</h3>

<pre>

## load example data
data("ExampleData.BINfileData", envir = environment())

## EXAMPLE 1

## convert Risoe.BINfileData object to RLum.Analysis object
data &lt;- Risoe.BINfileData2RLum.Analysis(object = CWOSL.SAR.Data, pos = 8, ltype = "OSL")

## extract all OSL curves
allCurves &lt;- get_RLum(data)

## keep only the natural and regenerated signal curves
pos &lt;- seq(1, 9, 2)
curves &lt;- allCurves[pos]

## plot a standard NR(t) plot
plot_NRt(curves)

## re-plot with rolling mean data smoothing
plot_NRt(curves, smooth = "rmean", k = 10)

## re-plot with a logarithmic x-axis
plot_NRt(curves, log = "x", smooth = "rmean", k = 5)

## re-plot with custom axes ranges
plot_NRt(curves, smooth = "rmean", k = 5,
         xlim = c(0.1, 5), ylim = c(0.4, 1.6),
         legend.pos = "bottomleft")

## re-plot with smoothing spline on log scale
plot_NRt(curves, smooth = "spline", log = "x",
         legend.pos = "top")

## EXAMPLE 2

# you may also use this function to check whether all
# TD curves follow the same shape (making it a TnTx(t) plot).
posTD &lt;- seq(2, 14, 2)
curves &lt;- allCurves[posTD]

plot_NRt(curves, main = "TnTx(t) Plot",
         smooth = "rmean", k = 20,
         ylab = "TD natural / TD regenerated",
         xlim = c(0, 20), legend = FALSE)

## EXAMPLE 3

# extract data from all positions
data &lt;- lapply(1:24, FUN = function(pos) {
   Risoe.BINfileData2RLum.Analysis(CWOSL.SAR.Data, pos = pos, ltype = "OSL")
})

# get individual curve data from each aliquot
aliquot &lt;- lapply(data, get_RLum)

# set graphical parameters
par(mfrow = c(2, 2))

# create NR(t) plots for all aliquots
for (i in 1:length(aliquot)) {
   plot_NRt(aliquot[[i]][pos],
            main = paste0("Aliquot #", i),
            smooth = "rmean", k = 20,
            xlim = c(0, 10),
            cex = 0.6, legend.pos = "bottomleft")
}

# reset graphical parameters
par(mfrow = c(1, 1))


</pre>

<hr /><div style="text-align: center;">[Package <em>Luminescence</em> version 0.9.15 <a href="00Index.html">Index</a>]</div>
</div></body></html>

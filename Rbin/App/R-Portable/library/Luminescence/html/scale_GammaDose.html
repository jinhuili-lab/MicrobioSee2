<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Calculate the gamma dose deposited within a sample taking...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for scale_GammaDose {Luminescence}"><tr><td>scale_GammaDose {Luminescence}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Calculate the gamma dose deposited within a sample taking layer-to-layer
variations in radioactivity into account (according to Aitken, 1985)</h2>

<h3>Description</h3>

<p>This function calculates the gamma dose deposited in a luminescence sample
taking into account layer-to-layer variations in sediment radioactivity .
The function scales user inputs of uranium, thorium and potassium based on
input parameters for sediment density, water content and given layer
thicknesses and distances to the sample.
</p>


<h3>Usage</h3>

<pre>
scale_GammaDose(
  data,
  conversion_factors = c("Cresswelletal2018", "Guerinetal2011", "AdamiecAitken1998",
    "Liritzisetal2013")[1],
  fractional_gamma_dose = c("Aitken1985")[1],
  verbose = TRUE,
  plot = TRUE,
  plot_single = TRUE,
  ...
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
<p><a href="../../base/html/data.frame.html">data.frame</a> (<strong>required</strong>):
A table containing all relevant information for each individual layer. The
table must have the following named columns:
</p>

<ul>
<li> <p><code>id</code> (<a href="../../base/html/character.html">character</a>): an arbitrary id or name of each layer
</p>
</li>
<li> <p><code>thickness</code> (<a href="../../base/html/numeric.html">numeric</a>): vertical extent of each layer in cm
</p>
</li>
<li> <p><code>sample_offset</code> (<a href="../../base/html/logical.html">logical</a>): distance of the sample in cm,
<strong>measured from the BOTTOM OF THE TARGET LAYER</strong>. Except for the target layer
all values must be <code>NA</code>.
</p>
</li>
<li> <p><code>K</code> (<a href="../../base/html/numeric.html">numeric</a>): K nuclide content in %
</p>
</li>
<li> <p><code>K_se</code> (<a href="../../base/html/numeric.html">numeric</a>): error on the K content
</p>
</li>
<li> <p><code>Th</code> (<a href="../../base/html/numeric.html">numeric</a>): Th nuclide content in ppm
</p>
</li>
<li> <p><code>Th_se</code> (<a href="../../base/html/numeric.html">numeric</a>): error on the Th content
</p>
</li>
<li> <p><code>U</code> (<a href="../../base/html/numeric.html">numeric</a>): U nuclide content in ppm
</p>
</li>
<li> <p><code>U_se</code> (<a href="../../base/html/numeric.html">numeric</a>): error on the U content
</p>
</li>
<li> <p><code>water_content</code> (<a href="../../base/html/numeric.html">numeric</a>): water content of each layer in %
</p>
</li>
<li> <p><code>water_content_se</code> (<a href="../../base/html/numeric.html">numeric</a>):  error on the water content
</p>
</li>
<li> <p><code>density</code> (<a href="../../base/html/numeric.html">numeric</a>): bulk density of each layer in g/cm^-3
</p>
</li></ul>
</td></tr>
<tr valign="top"><td><code>conversion_factors</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> (<em>optional</em>):
The conversion factors used to calculate the dose rate from sediment
nuclide contents. Valid options are:
</p>

<ul>
<li> <p><code>"Cresswelletal2018"</code> (default)
</p>
</li>
<li> <p><code>"Liritzisetal2013"</code>
</p>
</li>
<li> <p><code>"Guerinetal2011"</code>
</p>
</li>
<li> <p><code>"AdamiecAitken1998"</code>
</p>
</li></ul>
</td></tr>
<tr valign="top"><td><code>fractional_gamma_dose</code></td>
<td>
<p><a href="../../base/html/character.html">character</a> (<em>optional</em>):
Factors to scale gamma dose rate values. Valid options are:
</p>

<ul>
<li> <p><code>"Aitken1985"</code> (default): Table H1 in the appendix
</p>
</li></ul>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>optional</em>):
Show or hide console output (defaults to <code>TRUE</code>).</p>
</td></tr>
<tr valign="top"><td><code>plot</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>optional</em>):
Show or hide the plot (defaults to <code>TRUE</code>).</p>
</td></tr>
<tr valign="top"><td><code>plot_single</code></td>
<td>
<p><a href="../../base/html/logical.html">logical</a> (<em>optional</em>):
Show all plots in one panel (defaults to <code>TRUE</code>).</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Further parameters passed to <a href="../../graphics/html/barplot.html">barplot</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>User Input</strong>
</p>
<p>To calculate the gamma dose which is deposited in a sample, the user needs
to provide information on those samples influencing the luminescence sample.
As a rule of thumb, all sediment layers within at least 30 cm radius from
the luminescence sample taken should be taken into account when calculating
the gamma dose rate. However, the actual range of gamma radiation might be
different, depending on the emitting radioelement, the water content and the
sediment density of each layer (Aitken, 1985). Therefore the user is
advised to provide as much detail as possible and physically sensible.
</p>
<p>The function requires a <a href="../../base/html/data.frame.html">data.frame</a> that is to be structured
in columns and rows, with samples listed in rows. The first column contains
information on the layer/sample ID, the second on the thickness (in cm) of
each layer, whilst column 3 should contain <code>NA</code> for all layers that are not
sampled for OSL/TL. For the layer the OSL/TL sample was taken from a numerical
value must be provided, which is the distance (in cm) measured from <strong>bottom</strong>
of the layer of interest. If the whole layer was sampled insert <code>0</code>. If the
sample was taken from <em>within</em> the layer, insert a numerical value <code style="white-space: pre;">&gt;0</code>,
which describes the distance from the middle of the sample to the bottom of
the layer in cm. Columns 4 to 9 should  contain radionuclide concentrations
and their standard errors for
potassium (in %), thorium (in ppm) and uranium (in ppm). Columns 10 and 11
give information on the water content and its uncertainty (standard error)
in %. The layer density (in g/cm3) should be given in column 12. No cell
should be left blank. Please ensure to keep the column titles as given in
the example dataset (<code>data('ExampleData.ScaleGammaDose')</code>, see examples).
</p>
<p>The user can decide which dose rate
conversion factors should be used to calculate the gamma dose rates.
The options are:
</p>

<ul>
<li> <p><code>"Cresswelletal2018"</code> (Cresswell et al., 2018)
</p>
</li>
<li> <p><code>"Liritzisetal2013"</code> (Liritzis et al., 2013)
</p>
</li>
<li> <p><code>"Guerinetal2011"</code> (Guerin et al., 2011)
</p>
</li>
<li> <p><code>"AdamiecAitken1998"</code> (Adamiec and Aitken, 1998)
</p>
</li></ul>

<p><strong>Water content</strong>
</p>
<p>The water content provided by the user should be calculated according to:
</p>
<p style="text-align: center;"><i> ( Wet weight [g] - Dry weight [g] ) / Dry weight [g] * 100 </i></p>

<p><strong>Calculations</strong>
</p>
<p>After converting the radionuclide concentrations into dose rates, the
function will scale the dose rates based on the thickness of the layers,
the distances to the sample, the water content and the density of the sediment.
The calculations are based on Aitken (1985, Appendix H). As an example
(equivalent to Aitken, 1985), assuming three layers of sediment, where <strong>L</strong> is
inert and positioned in between the infinite thick and equally active
layers <strong>A</strong> and <strong>B</strong>, the dose in <strong>L</strong> and <strong>B</strong> due to <strong>A</strong> is given by
</p>
<p style="text-align: center;"><i> {1-f(x)}D_A </i></p>

<p>Where <code>x</code> is the distance into the inert medium, so <code>f(x)</code> is the weighted
average fractional dose at <code>x</code> and <code>D_A</code> denotes that the dose is delivered by <strong>A</strong>.
<code>f(x)</code> is derived from table H1 (Aitken, 1985), when setting <code>z = x</code>.
Consequently, the dose in <strong>A</strong> and <strong>L</strong> due to <strong>B</strong> is given by
</p>
<p style="text-align: center;"><i> {1 - f(t-x)}D_B </i></p>

<p>Here <code>t</code> is the thickness of <strong>L</strong> and the other parameters are denoted as above,
just for the dose being delivered by B. <code>f(t-x)</code> is derived from table H1
(Aitken, 1985), when setting <code>z</code> equal to <code>t-x</code>. Following this, the dose in <strong>L</strong>
delivered by <strong>A</strong> and <strong>B</strong> is given by
</p>
<p style="text-align: center;"><i> {2 - f(x) - f(t-x)}D_{AB} </i></p>

<p>Since <strong>A</strong> and <strong>B</strong> are equally active <code style="white-space: pre;">D_{AB} = D_A = D_B</code>.
</p>
<p>The function uses the value of the fractional dose rate at the layer
boundary to start the calculation for the next layer. This way, the function
is able to scale the gamma dose rate accurately for distant layers when the
density and water content is not constant for the entire section.
</p>


<h3>Value</h3>

<p>After performing the calculations the user is provided with different outputs.
</p>

<ol>
<li><p> The total gamma dose rate received by the sample (+/- uncertainties) as a
print in the console.
</p>
</li>
<li><p> A plot showing the sediment sequence, the user input sample information
and the contribution to total gamma dose rate.
</p>
</li>
<li><p> RLum Results. If the user wishes to save these results, writing a script
to run the function and to save the results would look like this:
</p>
</li></ol>
<pre>mydata &lt;- read.table("c:/path/to/input/file.txt")
results &lt;- scale_GammaDose(mydata)
table &lt;- get_RLum(results)
write.csv(table, "c:/path/to/results.csv")
</pre>
<p>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;<br />
<code style="white-space: pre;">[ NUMERICAL OUTPUT ]</code><br />
&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;<br />
</p>
<p><strong><code>RLum.Results</code></strong>-object
</p>
<p><strong>slot:</strong> <strong><code style="white-space: pre;">@data</code></strong>
</p>

<table summary="Rd table">
<tr>
 <td style="text-align: left;">
<strong>Element</strong> </td><td style="text-align: left;"> <strong>Type</strong> </td><td style="text-align: left;"> <strong>Description</strong></td>
</tr>
<tr>
 <td style="text-align: left;">
<code style="white-space: pre;">$summary</code> </td><td style="text-align: left;"> <code>data.frame</code> </td><td style="text-align: left;"> summary of the model results </td>
</tr>
<tr>
 <td style="text-align: left;">
<code style="white-space: pre;">$data</code> </td><td style="text-align: left;"> <code>data.frame</code> </td><td style="text-align: left;"> the original input data </td>
</tr>
<tr>
 <td style="text-align: left;">
<code style="white-space: pre;">$dose_rates</code> </td><td style="text-align: left;"> <code>list</code> </td><td style="text-align: left;"> two <code>data.frames</code> for the scaled and infinite matrix dose rates </td>
</tr>
<tr>
 <td style="text-align: left;">
<code style="white-space: pre;">$tables</code> </td><td style="text-align: left;"> <code>list</code> </td><td style="text-align: left;"> several <code>data.frames</code> containing intermediate results </td>
</tr>
<tr>
 <td style="text-align: left;">
<code style="white-space: pre;">$args</code> </td><td style="text-align: left;"> <code>character</code> </td><td style="text-align: left;"> arguments of the call </td>
</tr>
<tr>
 <td style="text-align: left;">
<code style="white-space: pre;">$call</code> </td><td style="text-align: left;"> <code>call</code> </td><td style="text-align: left;"> the original function call </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>slot:</strong> <strong><code style="white-space: pre;">@info</code></strong>
</p>
<p>Currently unused.
</p>
<p>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;<br />
<code style="white-space: pre;">[ PLOT OUTPUT ]</code><br />
&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;<br />
</p>
<p>Three plots are produced:
</p>

<ul>
<li><p> A visualisation of the provided sediment layer structure to quickly
assess whether the data was provided and interpreted correctly.
</p>
</li>
<li><p> A scatter plot of the nuclide contents per layer (K, Th, U) as well as the
water content. This may help to correlate the dose rate contribution of
specific layers to the layer of interest.
</p>
</li>
<li><p> A barplot visualising the contribution of each layer to the total dose rate
received by the sample in the target layer.
</p>
</li></ul>



<h3>Function version</h3>

<p>0.1.2
</p>


<h3>Acknowledgements</h3>

<p>We thank Dr Ian Bailiff for the provision of an excel spreadsheet, which has
been very helpful when writing this function.
</p>


<h3>How to cite</h3>

<p>Riedesel, S., Autzen, M., Burow, C., 2021. scale_GammaDose(): Calculate the gamma dose deposited within a sample taking layer-to-layer variations in radioactivity into account (according to Aitken, 1985). Function version 0.1.2. In: Kreutzer, S., Burow, C., Dietze, M., Fuchs, M.C., Schmidt, C., Fischer, M., Friedrich, J., Mercier, N., Philippe, A., Riedesel, S., Autzen, M., Mittelstrass, D., Gray, H.J., 2021. Luminescence: Comprehensive Luminescence Dating Data Analysis. R package version 0.9.15. https://CRAN.R-project.org/package=Luminescence
</p>


<h3>Note</h3>

<p><strong>This function has BETA status. If possible, results should be</strong>
<strong>cross-checked.</strong>
</p>


<h3>Author(s)</h3>

<p>Svenja Riedesel, Aberystwyth University (United Kingdom) <br />
Martin Autzen, DTU NUTECH Center for Nuclear Technologies (Denmark) <br />
Christoph Burow, University of Cologne (Germany) <br />
Based on an excel spreadsheet and accompanying macro written by Ian Bailiff.
, RLum Developer Team</p>


<h3>References</h3>

<p>Aitken, M.J., 1985. Thermoluminescence Dating. Academic Press, London.
</p>
<p>Adamiec, G., Aitken, M.J., 1998. Dose-rate conversion factors: update.
Ancient TL 16, 37-46.
</p>
<p>Cresswell., A.J., Carter, J., Sanderson, D.C.W., 2018.
Dose rate conversion parameters: Assessment of nuclear data.
Radiation Measurements 120, 195-201.
</p>
<p>Guerin, G., Mercier, N., Adamiec, G., 2011. Dose-rate conversion
factors: update. Ancient TL, 29, 5-8.
</p>
<p>Liritzis, I., Stamoulis, K., Papachristodoulou, C., Ioannides, K., 2013.
A re-evaluation of radiation dose-rate conversion factors. Mediterranean
Archaeology and Archaeometry 13, 1-15.
</p>


<h3>See Also</h3>

<p><a href="../../Luminescence/help/ExampleData.ScaleGammaDose.html">ExampleData.ScaleGammaDose</a>,
<a href="../../Luminescence/help/BaseDataSet.ConversionFactors.html">BaseDataSet.ConversionFactors</a>, <a href="../../stats/html/approxfun.html">approx</a>, <a href="../../graphics/html/barplot.html">barplot</a>
</p>


<h3>Examples</h3>

<pre>

# Load example data
data("ExampleData.ScaleGammaDose", envir = environment())
x &lt;- ExampleData.ScaleGammaDose

# Scale gamma dose rate
results &lt;- scale_GammaDose(data = x,
                           conversion_factors = "Cresswelletal2018",
                           fractional_gamma_dose = "Aitken1985",
                           verbose = TRUE,
                           plot = TRUE)

get_RLum(results)

</pre>

<hr /><div style="text-align: center;">[Package <em>Luminescence</em> version 0.9.15 <a href="00Index.html">Index</a>]</div>
</div></body></html>

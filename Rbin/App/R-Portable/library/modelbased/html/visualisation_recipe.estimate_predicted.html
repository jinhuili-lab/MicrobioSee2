<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Visualisation Recipe for 'modelbased' Objects</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for visualisation_recipe.estimate_grouplevel {modelbased}"><tr><td>visualisation_recipe.estimate_grouplevel {modelbased}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Visualisation Recipe for 'modelbased' Objects</h2>

<h3>Description</h3>

<p>Visualisation Recipe for 'modelbased' Objects
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'estimate_grouplevel'
visualisation_recipe(
  x,
  hline = NULL,
  pointrange = NULL,
  facet_wrap = NULL,
  labs = NULL,
  ...
)

## S3 method for class 'estimate_means'
visualisation_recipe(
  x,
  show_data = "jitter",
  point = NULL,
  jitter = point,
  boxplot = NULL,
  violin = NULL,
  line = NULL,
  pointrange = NULL,
  labs = NULL,
  ...
)

## S3 method for class 'estimate_predicted'
visualisation_recipe(
  x,
  show_data = "points",
  point = NULL,
  density_2d = NULL,
  line = NULL,
  ribbon = NULL,
  labs = NULL,
  ...
)

## S3 method for class 'estimate_slopes'
visualisation_recipe(
  x,
  hline = NULL,
  line = NULL,
  pointrange = NULL,
  ribbon = NULL,
  labs = NULL,
  facet_wrap = NULL,
  ...
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>A modelbased object.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Other arguments passed to other functions.</p>
</td></tr>
<tr valign="top"><td><code>show_data</code></td>
<td>
<p>Display the &quot;raw&quot; data as a background to the model-based
estimation. Can be set to <code>"none"</code> to remove it. When input is the result
of <code>estimate_means</code>, <code>show_data</code> can be &quot;points&quot; (the jittered observation
points), &quot;boxplot&quot;, &quot;violin&quot; a combination of them (see examples). When
input is the result of <code>estimate_response</code> or <code>estimate_relation</code>,
<code>show_data</code> can be &quot;points&quot; (the points of the original data corresponding
to the x and y axes), &quot;density_2d&quot;, &quot;density_2d_filled&quot;,
&quot;density_2d_polygon&quot; or &quot;density_2d_raster&quot;.</p>
</td></tr>
<tr valign="top"><td><code>point, jitter, boxplot, violin, pointrange, density_2d, line, hline, ribbon, labs, facet_wrap</code></td>
<td>
<p>Additional
aesthetics and parameters for the geoms (see customization example).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre>
# ==============================================
# estimate_grouplevel
# ==============================================
if (require("see") &amp;&amp; require("lme4")) {
  data &lt;- lme4::sleepstudy
  data &lt;- rbind(data, data)
  data$Newfactor &lt;- rep(c("A", "B", "C", "D"))

  # 1 random intercept
  model &lt;- lmer(Reaction ~ Days + (1 | Subject), data = data)
  x &lt;- estimate_grouplevel(model)
  layers &lt;- visualisation_recipe(x)
  layers
  plot(layers)
}

if (require("see") &amp;&amp; require("lme4")) {
  # 2 random intercepts
  model &lt;- lmer(Reaction ~ Days + (1 | Subject) + (1 | Newfactor), data = data)
  x &lt;- estimate_grouplevel(model)
  plot(visualisation_recipe(x))


  model &lt;- lmer(Reaction ~ Days + (1 + Days | Subject) + (1 | Newfactor), data = data)
  x &lt;- estimate_grouplevel(model)
  plot(visualisation_recipe(x))
}


# Simple Model ---------------
x &lt;- estimate_means(lm(Sepal.Width ~ Species, data = iris))
layers &lt;- visualisation_recipe(x)
layers
plot(layers)

# Customize aesthetics
layers &lt;- visualisation_recipe(x,
  jitter = list(width = 0.03, color = "red"),
  line = list(linetype = "dashed")
)
plot(layers)

# Customize raw data
plot(visualisation_recipe(x, show_data = c("violin", "boxplot", "jitter")))

# Two levels ---------------
data &lt;- mtcars
data$cyl &lt;- as.factor(data$cyl)
data$new_factor &lt;- as.factor(rep(c("A", "B"), length.out = nrow(mtcars)))

model &lt;- lm(mpg ~ new_factor * cyl * wt, data = data)
x &lt;- estimate_means(model, at = c("new_factor", "cyl"))
plot(visualisation_recipe(x))

# Modulations --------------
x &lt;- estimate_means(model, at = c("new_factor", "wt"))
plot(visualisation_recipe(x))

# x &lt;- estimate_means(model, at = c("new_factor", "cyl", "wt"))
# plot(visualisation_recipe(x))  # TODO: broken

#'   # GLMs ---------------------
data &lt;- data.frame(vs = mtcars$vs, cyl = as.factor(mtcars$cyl))
x &lt;- estimate_means(glm(vs ~ cyl, data = data, family = "binomial"))
plot(visualisation_recipe(x))


# ==============================================
# estimate_relation, estimate_response, ...
# ==============================================
if (require("ggplot2")) {
  # Simple Model ---------------
  x &lt;- estimate_relation(lm(mpg ~ wt, data = mtcars))
  layers &lt;- visualisation_recipe(x)
  layers
  plot(layers)
}

if (require("ggplot2")) {
  # Customize aesthetics ----------

  layers &lt;- visualisation_recipe(x,
    point = list(color = "red", alpha = 0.6, size = 3),
    line = list(color = "blue", size = 3),
    ribbon = list(fill = "green", alpha = 0.7),
    labs = list(subtitle = "Oh yeah!")
  )
  layers
  plot(layers)

  # Customize raw data -------------

  plot(visualisation_recipe(x, show_data = "none"))
  plot(visualisation_recipe(x, show_data = c("density_2d", "points")))
  plot(visualisation_recipe(x, show_data = "density_2d_filled"))
  plot(visualisation_recipe(x, show_data = "density_2d_polygon"))
  plot(visualisation_recipe(x, show_data = "density_2d_raster")) +
    scale_x_continuous(expand = c(0, 0)) +
    scale_y_continuous(expand = c(0, 0))

  # Single predictors examples -----------

  plot(estimate_relation(lm(Sepal.Length ~ Sepal.Width, data = iris)))
  plot(estimate_relation(lm(Sepal.Length ~ Species, data = iris)))

  # 2-ways interaction ------------

  # Numeric * numeric
  x &lt;- estimate_relation(lm(mpg ~ wt * qsec, data = mtcars))
  layers &lt;- visualisation_recipe(x)
  plot(layers)

  # Numeric * factor
  x &lt;- estimate_relation(lm(Sepal.Width ~ Sepal.Length * Species, data = iris))
  layers &lt;- visualisation_recipe(x)
  plot(layers)

  # Factor * numeric
  x &lt;- estimate_relation(lm(Sepal.Width ~ Species * Sepal.Length, data = iris))
  layers &lt;- visualisation_recipe(x)
  plot(layers)

  # 3-ways interaction ------------

  data &lt;- mtcars
  data$vs &lt;- as.factor(data$vs)
  data$cyl &lt;- as.factor(data$cyl)
  data$new_factor &lt;- as.factor(rep(c("A", "B"), length.out = nrow(mtcars)))

  # Numeric * numeric * numeric
  x &lt;- estimate_relation(lm(mpg ~ wt * qsec * hp, data = data), length = c(5, 3, 20))
  layers &lt;- visualisation_recipe(x)
  plot(layers)

  # Numeric * numeric * factor
  x &lt;- estimate_relation(lm(mpg ~ wt * am * vs, data = data))
  layers &lt;- visualisation_recipe(x)
  plot(layers)

  # Numeric * factor * factor
  x &lt;- estimate_relation(lm(mpg ~ wt * cyl * new_factor, data = data))
  layers &lt;- visualisation_recipe(x)
  plot(layers)

  # Factor * numeric * numeric
  x &lt;- estimate_relation(lm(mpg ~ cyl * qsec * hp, data = data))
  layers &lt;- visualisation_recipe(x)
  plot(layers) +
    scale_size_continuous(range = c(0.2, 1))

  # GLMs ---------------------
  x &lt;- estimate_relation(glm(vs ~ mpg, data = mtcars, family = "binomial"))
  plot(visualisation_recipe(x))
  plot(visualisation_recipe(x, show_data = "jitter", point = list(height = 0.03)))

  # Multiple CIs ---------------------
  plot(estimate_relation(lm(mpg ~ disp, data = mtcars),
    ci = c(.50, .80, .95)
  ))
  plot(estimate_relation(lm(Sepal.Length ~ Species, data = iris),
    ci = c(0.5, 0.7, 0.95)
  ))
}

# Bayesian models ---------------------
if (require("ggplot2") &amp;&amp; require("rstanarm")) {
  model &lt;- rstanarm::stan_glm(mpg ~ wt, data = mtcars, refresh = 0)

  # Plot individual draws instead of regular ribbon
  x &lt;- estimate_relation(model, keep_iterations = 100)
  layers &lt;- visualisation_recipe(x, ribbon = list(color = "red"))
  plot(layers)

  model &lt;- rstanarm::stan_glm(Sepal.Width ~ Species * Sepal.Length, data = iris, refresh = 0)
  plot(estimate_relation(model, keep_iterations = 100))
}

# ==============================================
# estimate_slopes
# ==============================================
if (require("ggplot2")) {
  model &lt;- lm(Sepal.Width ~ Species * Petal.Length, data = iris)
  x &lt;- estimate_slopes(model, trend = "Petal.Length", at = "Species")

  layers &lt;- visualisation_recipe(x)
  layers
  plot(layers)

  model &lt;- lm(Petal.Length ~ poly(Sepal.Width, 4), data = iris)
  x &lt;- estimate_slopes(model, at = "Sepal.Width", length = 20)
  plot(visualisation_recipe(x))

  model &lt;- lm(Petal.Length ~ Species * poly(Sepal.Width, 3), data = iris)
  x &lt;- estimate_slopes(model, at = c("Sepal.Width", "Species"))
  plot(visualisation_recipe(x))
}

# TODO: fails with latest emmeans (1.8.0)
if (require("mgcv")) {
  data &lt;- iris
  data$Petal.Length &lt;- data$Petal.Length^2

  model &lt;- mgcv::gam(Sepal.Width ~ t2(Petal.Width, Petal.Length), data = data)
  x &lt;- estimate_slopes(model, at = c("Petal.Width", "Petal.Length"), length = 20)
  plot(visualisation_recipe(x))

  model &lt;- mgcv::gam(Sepal.Width ~ t2(Petal.Width, Petal.Length, by = Species), data = data)
  x &lt;- estimate_slopes(model, at = c("Petal.Width", "Petal.Length", "Species"), length = 10)
  plot(visualisation_recipe(x))
}

</pre>

<hr /><div style="text-align: center;">[Package <em>modelbased</em> version 0.8.7 <a href="00Index.html">Index</a>]</div>
</div></body></html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Highest Density Interval (HDI)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for hdi {bayestestR}"><tr><td>hdi {bayestestR}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Highest Density Interval (HDI)</h2>

<h3>Description</h3>

<p>Compute the <strong>Highest Density Interval (HDI)</strong> of posterior distributions.
All points within this interval have a higher probability density than points
outside the interval. The HDI can be used in the context of uncertainty
characterisation of posterior distributions as <strong>Credible Interval (CI)</strong>.
</p>


<h3>Usage</h3>

<pre>
hdi(x, ...)

## S3 method for class 'numeric'
hdi(x, ci = 0.95, verbose = TRUE, ...)

## S3 method for class 'data.frame'
hdi(x, ci = 0.95, verbose = TRUE, ...)

## S3 method for class 'stanreg'
hdi(
  x,
  ci = 0.95,
  effects = c("fixed", "random", "all"),
  component = c("location", "all", "conditional", "smooth_terms", "sigma",
    "distributional", "auxiliary"),
  parameters = NULL,
  verbose = TRUE,
  ...
)

## S3 method for class 'brmsfit'
hdi(
  x,
  ci = 0.95,
  effects = c("fixed", "random", "all"),
  component = c("conditional", "zi", "zero_inflated", "all"),
  parameters = NULL,
  verbose = TRUE,
  ...
)

## S3 method for class 'get_predicted'
hdi(x, ci = 0.95, use_iterations = FALSE, verbose = TRUE, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>Vector representing a posterior distribution, or a data frame of such
vectors. Can also be a Bayesian model. <strong>bayestestR</strong> supports a wide range
of models (see, for example, <code>methods("hdi")</code>) and not all of those are
documented in the 'Usage' section, because methods for other classes mostly
resemble the arguments of the <code>.numeric</code> or <code>.data.frame</code>methods.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr valign="top"><td><code>ci</code></td>
<td>
<p>Value or vector of probability of the (credible) interval - CI
(between 0 and 1) to be estimated. Default to <code>.95</code> (<code style="white-space: pre;">95%</code>).</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>Toggle off warnings.</p>
</td></tr>
<tr valign="top"><td><code>effects</code></td>
<td>
<p>Should results for fixed effects, random effects or both be
returned? Only applies to mixed models. May be abbreviated.</p>
</td></tr>
<tr valign="top"><td><code>component</code></td>
<td>
<p>Should results for all parameters, parameters for the
conditional model or the zero-inflated part of the model be returned? May
be abbreviated. Only applies to <span class="pkg">brms</span>-models.</p>
</td></tr>
<tr valign="top"><td><code>parameters</code></td>
<td>
<p>Regular expression pattern that describes the parameters
that should be returned. Meta-parameters (like <code>lp__</code> or <code>prior_</code>) are
filtered by default, so only parameters that typically appear in the
<code>summary()</code> are returned. Use <code>parameters</code> to select specific parameters
for the output.</p>
</td></tr>
<tr valign="top"><td><code>use_iterations</code></td>
<td>
<p>Logical, if <code>TRUE</code> and <code>x</code> is a <code>get_predicted</code> object,
(returned by <code><a href="../../insight/help/get_predicted.html">insight::get_predicted()</a></code>), the function is applied to the
iterations instead of the predictions. This only applies to models that return
iterations for predicted values (e.g., <code>brmsfit</code> models).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Unlike equal-tailed intervals (see <code>eti()</code>) that typically exclude <code style="white-space: pre;">2.5%</code>
from each tail of the distribution and always include the median, the HDI is
<em>not</em> equal-tailed and therefore always includes the mode(s) of posterior
distributions. While this can be useful to better represent the credibility
mass of a distribution, the HDI also has some limitations. See <code><a href="../../bayestestR/help/spi.html">spi()</a></code> for
details.
</p>
<p>The <a href="https://easystats.github.io/bayestestR/articles/credible_interval.html"><code style="white-space: pre;">95%</code> or <code style="white-space: pre;">89%</code> Credible Intervals (CI)</a>
are two reasonable ranges to characterize the uncertainty related to the
estimation (see <a href="https://easystats.github.io/bayestestR/articles/credible_interval.html">here</a>
for a discussion about the differences between these two values).
</p>
<p>The <code style="white-space: pre;">89%</code> intervals (<code>ci = 0.89</code>) are deemed to be more stable than, for
instance, <code style="white-space: pre;">95%</code> intervals (<em>Kruschke, 2014</em>). An effective sample size
of at least 10.000 is recommended if one wants to estimate <code style="white-space: pre;">95%</code> intervals
with high precision (<em>Kruschke, 2014, p. 183ff</em>). Unfortunately, the
default number of posterior samples for most Bayes packages (e.g., <code>rstanarm</code>
or <code>brms</code>) is only 4.000 (thus, you might want to increase it when fitting
your model). Moreover, 89 indicates the arbitrariness of interval limits -
its only remarkable property is being the highest prime number that does not
exceed the already unstable <code style="white-space: pre;">95%</code> threshold (<em>McElreath, 2015</em>).
</p>
<p>However, <code style="white-space: pre;">95%</code> has some <a href="https://easystats.github.io/blog/posts/bayestestr_95/">advantages too</a>. For instance, it
shares (in the case of a normal posterior distribution) an intuitive
relationship with the standard deviation and it conveys a more accurate image
of the (artificial) bounds of the distribution. Also, because it is wider, it
makes analyses more conservative (i.e., the probability of covering 0 is
larger for the <code style="white-space: pre;">95%</code> CI than for lower ranges such as <code style="white-space: pre;">89%</code>), which is a good
thing in the context of the reproducibility crisis.
</p>
<p>A <code style="white-space: pre;">95%</code> equal-tailed interval (ETI) has <code style="white-space: pre;">2.5%</code> of the distribution on either
side of its limits. It indicates the 2.5th percentile and the 97.5h
percentile. In symmetric distributions, the two methods of computing credible
intervals, the ETI and the <a href="../../bayestestR/help/hdi.html">HDI</a>, return similar results.
</p>
<p>This is not the case for skewed distributions. Indeed, it is possible that
parameter values in the ETI have lower credibility (are less probable) than
parameter values outside the ETI. This property seems undesirable as a summary
of the credible values in a distribution.
</p>
<p>On the other hand, the ETI range does change when transformations are applied
to the distribution (for instance, for a log odds scale to probabilities):
the lower and higher bounds of the transformed distribution will correspond
to the transformed lower and higher bounds of the original distribution.
On the contrary, applying transformations to the distribution will change
the resulting HDI.
</p>


<h3>Value</h3>

<p>A data frame with following columns:
</p>

<ul>
<li> <p><code>Parameter</code> The model parameter(s), if <code>x</code> is a model-object. If <code>x</code> is a
vector, this column is missing.
</p>
</li>
<li> <p><code>CI</code> The probability of the credible interval.
</p>
</li>
<li> <p><code>CI_low</code>, <code>CI_high</code> The lower and upper credible interval limits for the parameters.
</p>
</li></ul>



<h3>Note</h3>

<p>There is also a <a href="https://easystats.github.io/see/articles/bayestestR.html"><code>plot()</code>-method</a> implemented in the <a href="https://easystats.github.io/see/"><span class="pkg">see</span>-package</a>.
</p>


<h3>Author(s)</h3>

<p>Credits go to <strong>ggdistribute</strong> and <a href="https://github.com/mikemeredith/HDInterval"><strong>HDInterval</strong></a>.
</p>


<h3>References</h3>


<ul>
<li><p> Kruschke, J. (2014). Doing Bayesian data analysis: A tutorial with R, JAGS,
and Stan. Academic Press.
</p>
</li>
<li><p> McElreath, R. (2015). Statistical rethinking: A Bayesian course with
examples in R and Stan. Chapman and Hall/CRC.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other interval functions, such as <code><a href="../../bayestestR/help/hdi.html">hdi()</a></code>, <code><a href="../../bayestestR/help/eti.html">eti()</a></code>, <code><a href="../../bayestestR/help/bci.html">bci()</a></code>, <code><a href="../../bayestestR/help/spi.html">spi()</a></code>, <code><a href="../../bayestestR/help/si.html">si()</a></code>, <code><a href="../../bayestestR/help/cwi.html">cwi()</a></code>.
</p>
<p>Other ci: 
<code><a href="../../bayestestR/help/bci.html">bci</a>()</code>,
<code><a href="../../bayestestR/help/ci.html">ci</a>()</code>,
<code><a href="../../bayestestR/help/cwi.html">cwi</a>()</code>,
<code><a href="../../bayestestR/help/eti.html">eti</a>()</code>,
<code><a href="../../bayestestR/help/si.html">si</a>()</code>,
<code><a href="../../bayestestR/help/spi.html">spi</a>()</code>
</p>


<h3>Examples</h3>

<pre>

library(bayestestR)

posterior &lt;- rnorm(1000)
hdi(posterior, ci = 0.89)
hdi(posterior, ci = c(0.80, 0.90, 0.95))

bayestestR::hdi(iris[1:4])
bayestestR::hdi(iris[1:4], ci = c(0.80, 0.90, 0.95))

model &lt;- suppressWarnings(
  rstanarm::stan_glm(mpg ~ wt + gear, data = mtcars, chains = 2, iter = 200, refresh = 0)
)
bayestestR::hdi(model)
bayestestR::hdi(model, ci = c(0.80, 0.90, 0.95))

bayestestR::hdi(emmeans::emtrends(model, ~1, "wt", data = mtcars))

model &lt;- brms::brm(mpg ~ wt + cyl, data = mtcars)
bayestestR::hdi(model)
bayestestR::hdi(model, ci = c(0.80, 0.90, 0.95))

bf &lt;- BayesFactor::ttestBF(x = rnorm(100, 1, 1))
bayestestR::hdi(bf)
bayestestR::hdi(bf, ci = c(0.80, 0.90, 0.95))


</pre>

<hr /><div style="text-align: center;">[Package <em>bayestestR</em> version 0.13.2 <a href="00Index.html">Index</a>]</div>
</div></body></html>
